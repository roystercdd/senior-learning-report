<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
       
      <meta name="keywords" content="ç”Ÿæ´»,æ€è€ƒ,ä»£ç ,åšå®¢,æ‘„å½±" />
       
      <meta name="description" content="æ¬¢è¿å…‰ä¸´CDDçš„ä¸ªäººç½‘ç«™~~~" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>å¤æ‚æ•°è®º |  æ¼‚è‡³</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/deadpool.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="æ¼‚è‡³" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-å¤æ‚æ•°è®º"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  å¤æ‚æ•°è®º
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2024/10/07/%E5%A4%8D%E6%9D%82%E6%95%B0%E8%AE%BA/" class="article-date">
  <time datetime="2024-10-07T02:50:20.000Z" itemprop="datePublished">2024-10-07</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0/">å­¦ä¹ </a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> å­—æ•°ç»Ÿè®¡:</span>
            <span class="post-count">8.2k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> é˜…è¯»æ—¶é•¿â‰ˆ</span>
            <span class="post-count">39 åˆ†é’Ÿ</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <meta name="referrer" content="no-referrer">

<h1><span id="å¤æ‚æ•°è®º">å¤æ‚æ•°è®º</span></h1><!-- toc -->

<ul>
<li><a href="#1-%E8%B4%A8%E6%95%B0%E5%88%A4%E6%96%AD">1. è´¨æ•°åˆ¤æ–­</a></li>
<li><a href="#2-%E5%88%86%E8%A7%A3%E8%B4%A8%E5%9B%A0%E6%95%B0">2. åˆ†è§£è´¨å› æ•°</a><ul>
<li><a href="#21-%E8%AF%95%E9%99%A4%E6%B3%95">2.1. è¯•é™¤æ³•</a></li>
<li><a href="#22-%E6%9E%9A%E4%B8%BE%E6%AC%A1%E6%95%B0%E4%BC%98%E5%8C%96">2.2. æšä¸¾æ¬¡æ•°ä¼˜åŒ–</a></li>
</ul>
</li>
<li><a href="#3-%E8%B4%A8%E6%95%B0%E7%AD%9B">3. è´¨æ•°ç­›</a><ul>
<li><a href="#31-%E6%9C%B4%E7%B4%A0%E6%B3%95">3.1. æœ´ç´ æ³•</a></li>
<li><a href="#32-%E5%9F%83%E5%8F%8A%E7%AD%9B">3.2. åŸƒåŠç­›</a></li>
<li><a href="#33-%E6%AC%A7%E6%8B%89%E7%AD%9B">3.3. æ¬§æ‹‰ç­›</a></li>
</ul>
</li>
<li><a href="#4-%E7%BA%A6%E6%95%B0">4. çº¦æ•°</a><ul>
<li><a href="#41-%E8%AF%95%E9%99%A4%E6%B3%95%E6%B1%82%E7%BA%A6%E6%95%B0%E4%B8%AA%E6%95%B0">4.1. è¯•é™¤æ³•æ±‚çº¦æ•°ä¸ªæ•°</a></li>
<li><a href="#42-%E5%85%AC%E5%BC%8F%E6%B1%82%E7%BA%A6%E6%95%B0%E4%B8%AA%E6%95%B0">4.2. å…¬å¼æ±‚çº¦æ•°ä¸ªæ•°</a></li>
<li><a href="#43-%E7%BA%A6%E6%95%B0%E4%B9%8B%E5%92%8C">4.3. çº¦æ•°ä¹‹å’Œ</a></li>
</ul>
</li>
<li><a href="#4-%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0">4. æœ€å¤§å…¬çº¦æ•°</a></li>
<li><a href="#5-%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0">5. æ¬§æ‹‰å‡½æ•°</a><ul>
<li><a href="#51-%E5%AE%9A%E4%B9%89%E6%B3%95">5.1. å®šä¹‰æ³•</a></li>
<li><a href="#52-%E7%AD%9B%E6%B3%95">5.2. ç­›æ³•</a></li>
<li><a href="#53-%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86">5.3. æ¬§æ‹‰å®šç†</a></li>
</ul>
</li>
<li><a href="#6-%E5%BF%AB%E9%80%9F%E5%B9%82">6. å¿«é€Ÿå¹‚</a><ul>
<li><a href="#61-%E5%BF%AB%E9%80%9F%E5%B9%82">6.1. å¿«é€Ÿå¹‚</a></li>
<li><a href="#62-%E5%BF%AB%E9%80%9F%E5%B9%82%E6%B1%82%E9%80%86%E5%85%83">6.2. å¿«é€Ÿå¹‚æ±‚é€†å…ƒ</a></li>
</ul>
</li>
<li><a href="#7-%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95">7. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</a><ul>
<li><a href="#71-%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86">7.1. è£´èœ€å®šç†</a></li>
<li><a href="#72-%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97">7.2. æ‰©å±•æ¬§å‡ é‡Œå¾—</a></li>
<li><a href="#73-%E5%BA%94%E7%94%A8%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B">7.3. ã€åº”ç”¨ã€‘çº¿æ€§åŒä½™æ–¹ç¨‹</a></li>
<li><a href="#74-%E5%BA%94%E7%94%A8%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86">7.4. ã€åº”ç”¨ã€‘ä¸­å›½å‰©ä½™å®šç†</a></li>
</ul>
</li>
<li><a href="#8-%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83">8. é«˜æ–¯æ¶ˆå…ƒ</a><ul>
<li><a href="#81-%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83%E8%A7%A3%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84">8.1. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„</a></li>
<li><a href="#82-%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83%E8%A7%A3%E5%BC%82%E6%88%96%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84">8.2. é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„</a></li>
</ul>
</li>
<li><a href="#9-%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6">9. ç»„åˆæ•°å­¦</a><ul>
<li><a href="#91-%E7%BB%84%E5%90%88%E6%95%B0">9.1. ç»„åˆæ•°</a><ul>
<li><a href="#911-%E6%9C%B4%E7%B4%A0%E6%B3%95">9.1.1. æœ´ç´ æ³•</a></li>
<li><a href="#912-%E5%BF%AB%E9%80%9F%E5%B9%82">9.1.2. å¿«é€Ÿå¹‚</a></li>
<li><a href="#913-%E5%8D%A2%E5%8D%A1%E6%96%AF%E5%AE%9A%E7%90%86">9.1.3. å¢å¡æ–¯å®šç†</a></li>
<li><a href="#914-%E7%BA%BF%E6%80%A7%E7%AD%9B%E9%AB%98%E7%B2%BE%E4%B9%98">9.1.4. çº¿æ€§ç­›+é«˜ç²¾ä¹˜</a></li>
</ul>
</li>
<li><a href="#92-%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0">9.2. å¡ç‰¹å…°æ•°</a></li>
</ul>
</li>
<li><a href="#10-%E5%AE%B9%E6%96%A5%E5%8E%9F%E7%90%86">10. å®¹æ–¥åŸç†</a></li>
</ul>
<!-- tocstop -->

<span id="more"></span>



<blockquote>
<p>æœ€æ²¡æœ‰è‡ªä¿¡çš„ä¸€ç« å“ˆå“ˆğŸ˜…</p>
</blockquote>
<h2><span id="1-è´¨æ•°åˆ¤æ–­">1. è´¨æ•°åˆ¤æ–­</span></h2><blockquote>
<p>æ—¶é—´å¤æ‚åº¦ $O(n)â†’O(\sqrt n)$</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1:æœ´ç´ è¯•é™¤</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isPrime</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;<span class="number">2</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>) </span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2:æšä¸¾æ¬¡æ•°ä¼˜åŒ–â†’sqrt:è¿™ä¸ªå‡½æ•°æœ¬èº«é€Ÿåº¦è¾ƒæ…¢,ä¸æ¨è</span></span><br><span class="line"><span class="comment">// åŒ…æ‹¬ i*i&lt;=n è¿™ç§å†™æ³•ä¹Ÿä¸æ¨è,å› ä¸ºi*iå¯èƒ½å°äºç­‰äºn,ä½†æ˜¯(i+1)*(i+1)å¯èƒ½ä¼šæº¢å‡ºintå‹æœ€å¤§å€¼,å¦‚æœæº¢å‡ºäº†å°±ä¼šå˜æˆä¸€ä¸ªè´Ÿæ•°,ä»è€Œå½±å“æœ€ç»ˆç­”æ¡ˆçš„åˆ¤æ–­</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isPrime</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;<span class="number">2</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=<span class="built_in">sqrt</span>(n);i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>) </span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3:æœ€ä½³å†™æ³•åº”è¯¥æ˜¯i&lt;=n/i,é€Ÿåº¦å¿«å¹¶ä¸”ä¸ä¼šæº¢å‡º</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isPrime</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;<span class="number">2</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n/i;i++) &#123;	</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>) </span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2><span id="2-åˆ†è§£è´¨å› æ•°">2. åˆ†è§£è´¨å› æ•°</span></h2><blockquote>
<p>è´¨å› æ•°çš„åº•æ•°å’ŒæŒ‡æ•°ï¼šåº•æ•°æŒ‡è´¨æ•°çš„åŸºæ•°ï¼Œæ¯”å¦‚åˆ†è§£12&#x3D;2Ã—2Ã—3æ—¶ï¼Œ2å’Œ3å°±æ˜¯åº•æ•°ï¼Œè€ŒæŒ‡æ•°æŒ‡çš„æ˜¯å„ä¸ªåŸºæ•°å‡ºç°çš„æ¬¡æ•°ï¼Œ2çš„æŒ‡æ•°æ˜¯2ï¼Œ3çš„æŒ‡æ•°æ˜¯1</p>
</blockquote>
<h3><span id="21-è¯•é™¤æ³•">2.1. è¯•é™¤æ³•</span></h3><blockquote>
<p>æ—¶é—´å¤æ‚åº¦ $O(n)$</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">divede</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++) &#123;</span><br><span class="line">		<span class="comment">// å…ˆæ‰¾åˆ°è¿™ä¸ªè´¨æ•°</span></span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>) &#123;</span><br><span class="line">			<span class="comment">// å†æ±‚è´¨æ•°å‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line">			<span class="type">int</span> s=<span class="number">0</span>;</span><br><span class="line">			<span class="comment">// å½“n%iä¸ç­‰äº0äº†,è¯´æ˜ä¸å†è¢«æ•´é™¤,æŒ‡æ•°æ±‚å®Œäº†</span></span><br><span class="line">			<span class="keyword">while</span>(n%i==<span class="number">0</span>) &#123;</span><br><span class="line">				n/=i;</span><br><span class="line">				s++;</span><br><span class="line">			&#125;</span><br><span class="line">			cout&lt;&lt;i&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;s&lt;&lt;endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="22-æšä¸¾æ¬¡æ•°ä¼˜åŒ–">2.2. æšä¸¾æ¬¡æ•°ä¼˜åŒ–</span></h3><ul>
<li>å¯¹ä¸Šè¿°ç®—æ³•è¿›è¡Œä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜nä¸­æœ€å¤šåŒ…å«ä¸€ä¸ªå¤§äºsqrt(n)çš„è´¨å› å­ï¼ˆå‡è®¾æœ‰ä¸¤ä¸ªçš„è¯ï¼Œä¸¤ä¸ªå¤§äºsqrt(n)çš„è´¨å› å­ç›¸ä¹˜çš„ç»“æœå°±å¤§äºnäº†ï¼Œæ‰€ä»¥ä¸æˆç«‹ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥å’Œä¼˜åŒ–æ±‚è´¨æ•°æ—¶ä¸€æ ·çš„åšæ³•æ¥å‡å°‘æšä¸¾æ¬¡æ•°ã€‚</li>
</ul>
<blockquote>
<p>æ—¶é—´å¤æ‚åº¦ $[O(log(n)),\ O(sqrt(n))]$</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">divede</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n/i;i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>) &#123;</span><br><span class="line">			<span class="type">int</span> s=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(n%i==<span class="number">0</span>) &#123;</span><br><span class="line">				n/=i;</span><br><span class="line">				s++;</span><br><span class="line">			&#125;</span><br><span class="line">			cout&lt;&lt;i&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;s&lt;&lt;endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// å› ä¸ºæˆ‘ä»¬è¯æ˜äº†å¤§äºsqrt(n)çš„æ•°æœ€å¤šåªæœ‰ä¸€ä¸ª</span></span><br><span class="line">	<span class="comment">// é‚£ä¹ˆnå¦‚æœè¿˜&gt;1,è¯´æ˜æ²¡é™¤å®Œ,é‚£å‰©ä¸‹çš„é‚£ä¸ªå¿…å®šå°±æ˜¯å¤§äºsqrt(n)çš„è´¨å› å­</span></span><br><span class="line">	<span class="keyword">if</span>(n&gt;<span class="number">1</span>)</span><br><span class="line">		cout&lt;&lt;n&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;<span class="number">1</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2><span id="3-è´¨æ•°ç­›">3. è´¨æ•°ç­›</span></h2><h3><span id="31-æœ´ç´ æ³•">3.1. æœ´ç´ æ³•</span></h3><blockquote>
<p>æ—¶é—´å¤æ‚åº¦çº¦ç­‰äº $O(nln^n)&lt;O(nlog^n)$</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span><span class="number">+10</span>; <span class="comment">// ç­›é€‰1~1e6+10ä¸­çš„è´¨æ•°</span></span><br><span class="line"><span class="comment">// primes:è®°å½•è´¨æ•°å°äºç­‰äºNçš„æ‰€æœ‰è´¨æ•°,cnt:è®°å½•è´¨æ•°ä¸ªæ•°</span></span><br><span class="line"><span class="comment">// primesä¸­ä¸‹æ ‡ä¸º0~cnt-1å­˜å‚¨çš„å°±æ˜¯æ‰€æœ‰å°äºç­‰äºNçš„è´¨æ•°</span></span><br><span class="line"><span class="type">int</span> primes[N],cnt; </span><br><span class="line"><span class="type">bool</span> st[N]; <span class="comment">// è®°å½•æ¯ä¸ªæ•°çš„è®¿é—®çŠ¶æ€,ä¸ºtrueçš„è¯´æ˜ä¸æ˜¯è´¨æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_primes</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ä»2å¼€å§‹éå†æ•°å­—,å¹¶æŠŠå…¶å¯¹åº”å€æ•°çš„æ•°å­—å…¨éƒ¨è®¾ç½®æˆå·²è®¿é—®</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++) &#123;</span><br><span class="line">		<span class="comment">// å¦‚æœæ²¡æœ‰è®¿é—®è¿‡</span></span><br><span class="line">		<span class="keyword">if</span>(!st[i]) &#123;</span><br><span class="line">			primes[cnt++]=i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// ä»i*2å¼€å§‹,åªè¦æ˜¯içš„å€æ•°éƒ½è®¾ç½®æˆå·²è®¿é—®</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=i+i;j&lt;=n;j+=i)</span><br><span class="line">			st[j]=<span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="32-åŸƒåŠç­›">3.2. åŸƒåŠç­›</span></h3><blockquote>
<p>æšä¸¾ä¼˜åŒ–ï¼Œæ—¶é—´å¤æ‚åº¦ $O(nlg^{lg^n})$ï¼Œçº¦ç­‰äº $O(n)$</p>
</blockquote>
<ul>
<li>è´¨æ•°å®šç†ï¼š1~nå½“ä¸­æœ‰ $n&#x2F;ln(n)$ ä¸ªè´¨æ•°ï¼Œæˆ‘ä»¬åœ¨éå†çš„æ—¶å€™åªæŠŠè´¨æ•°é€‰å‡ºæ¥</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_primes</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(!st[i]) &#123;</span><br><span class="line">			<span class="comment">// å†é€‰å‡ºåŸºç¡€æ•°çš„åŸºç¡€ä¸Šç›´æ¥åœ¨æ­¤éå†ç­›è´¨æ•°</span></span><br><span class="line">			primes[cnt++]=i;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j=i+i;j&lt;=n;j+=i)</span><br><span class="line">				st[j]=<span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="33-æ¬§æ‹‰ç­›">3.3. æ¬§æ‹‰ç­›</span></h3><blockquote>
<p>æ—¶é—´å¤æ‚åº¦ $O(n)$ï¼ŒçœŸæ­£æ„ä¹‰ä¸Šçš„çº¿æ€§ç­›</p>
</blockquote>
<ul>
<li>çº¿æ€§ç­›æ³•å°±åœ¨æ¬§æ‹‰ç­›çš„åŸºç¡€ä¸Šæ”¹è¿›äº†ä¸€ä¸ªä¸œè¥¿ï¼Œ$n$ åªä¼šè¢«æœ€å°è´¨å› å­ç­›æ‰ï¼Œæ¬§æ‹‰ç­›ã€åŸƒåŠç­›éƒ½æ˜¯å»ºç«‹åœ¨2æ˜¯å…¬è®¤çš„æœ€å°çš„è´¨æ•°ä¸Šåšçš„ï¼Œå»ºè®®ç–¯ç‹‚çœ‹æ³¨é‡Šç†è§£å—·</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> primes[N],cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_primes</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(!st[i])</span><br><span class="line">			primes[cnt++]=i;</span><br><span class="line">		<span class="comment">// primes[j](è´¨æ•°)*i&lt;=n,éå†primes[j]å³ä¸º:primesæ•°ç»„ä¸­å½“å‰çš„æ‰€æœ‰è´¨æ•°</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;primes[j]&lt;=n/i;j++) &#123;</span><br><span class="line">			<span class="comment">// primes[j]ä¸€å®šæ˜¯içš„æœ€å°è´¨å› å­,primes[j]ä¸€å®šä¹Ÿæ˜¯primes[j]*içš„æœ€å°è´¨å› å­</span></span><br><span class="line">			st[primes[j]*i]=<span class="literal">true</span>;</span><br><span class="line">			<span class="comment">// å¯¹äºä¸€ä¸ªåˆæ•°x,å‡è®¾primes[j]æ˜¯xçš„æœ€å°è´¨å› å­,å½“iæšä¸¾åˆ°x/primes[j]æ—¶å°±break</span></span><br><span class="line">			<span class="comment">// å•¥å­æ„æ€,å°±æ˜¯è¯´æˆ‘iæ˜¯ä¸ªåˆæ•°çš„è¯å°±åªç­›ä¸€é,è¿™æ ·æ‰èƒ½è¾¾åˆ°è¿‘ä¼¼O(n)çš„æ•ˆæœ</span></span><br><span class="line">			<span class="comment">// æ¯”å¦‚i=6æ—¶,è´¨æ•°é›†ä¸­æœ‰2,3,5è¿™ä¸‰ä¸ªæ•°,é‚£ä¹ˆæˆ‘åªç­›2*6=12,3*6å’Œ5*6ä¸ç­›</span></span><br><span class="line">			<span class="comment">// ä¸ºä»€ä¹ˆä¸ç­›?å› ä¸ºæˆ‘åœ¨ç®—3*6=18æ—¶,i=9,9*2ä¹Ÿä¸º18,å…¶å®ä¹Ÿç­›æ‰äº†</span></span><br><span class="line">			<span class="comment">// æ‰€ä»¥å¯¹äºåˆæ•°,æˆ‘ä»¬åªç”¨å…¶æœ€å°è´¨å› å­æ¥ç­›,æå‰breakå°±å¯ä»¥é¿å…é‡å¤ç­›</span></span><br><span class="line">			<span class="keyword">if</span>(i%primes[j]==<span class="number">0</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2><span id="4-çº¦æ•°">4. çº¦æ•°</span></h2><h3><span id="41-è¯•é™¤æ³•æ±‚çº¦æ•°ä¸ªæ•°">4.1. è¯•é™¤æ³•æ±‚çº¦æ•°ä¸ªæ•°</span></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ±‚å–çº¦æ•°çš„å‡½æ•°</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">get_divisors</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">	<span class="comment">// æšä¸¾ä¼˜åŒ–</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n/i;i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>) &#123;</span><br><span class="line">			res.<span class="built_in">push_back</span>(i);</span><br><span class="line">			<span class="comment">// å¦‚æœiå’Œn/iæ˜¯åŒä¸€ä¸ªæ•°å­—,é‚£ä¹ˆåªç”¨æ”¾ä¸€é</span></span><br><span class="line">			<span class="keyword">if</span>(i!=n/i)</span><br><span class="line">				res.<span class="built_in">push_back</span>(n/i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(res.<span class="built_in">begin</span>(),res.<span class="built_in">end</span>()); <span class="comment">// ä»å°åˆ°å¤§æ’åº</span></span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="42-å…¬å¼æ±‚çº¦æ•°ä¸ªæ•°">4.2. å…¬å¼æ±‚çº¦æ•°ä¸ªæ•°</span></h3><ul>
<li>åŸºäºç®—æœ¯åŸºæœ¬å®šç†ï¼Œ$N$ çš„çº¦æ•°çš„ä¸ªæ•°å°±å’Œ $[Î²_1,Î²_k]$ çš„å–æ³•æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼›æ‰€ä»¥ $[Î²_1,Î²_k]$ å°±æ˜¯ $Î±_1$ çš„é€‰æ³•ï¼Œå…± $(Î±_1+1)$ ç§ï¼Œä¹Ÿè¡¨ç¤º $Î±2$ çš„é€‰æ³•ï¼Œå…± $(Î±_2+1)$ ç§ï¼Œæ ¹æ®ä¹˜æ³•å®šç†ï¼Œæ‰€ä»¥ï¼šå¯¹äºä¸€ä¸ªæ•° $N$ï¼Œçº¦æ•°ä¸ªæ•°ä¸€å®šæ˜¯ $(Î±_1+1)Ã—(Î±_2+1)Ã—(Î±_3+1)Ã—Â·Â·Â·(Î±_k+1)$</li>
<li>åªè¦æˆ‘ä»¬èƒ½æ±‚è§£å‡ºä¸€ä¸ªæ•°åˆ†è§£è´¨å› æ•°çš„ç»“æœï¼Œå°±èƒ½æ±‚å‡ºå…¶çº¦æ•°ä¸ªæ•°</li>
</ul>
<p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231201152205955.png" alt="image-20231201152205955"></p>
<ul>
<li>PSï¼šintèŒƒå›´å†…ï¼Œçº¦æ•°ä¸ªæ•°æœ€å¤šçš„æ•°çš„çº¦æ•°ä¸ªæ•°å¤§æ¦‚æ˜¯1500å·¦å³ã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠå› å¼åˆ†è§£æ¯ä¸ªåŸºæ•°çš„åº•æ•°å’ŒæŒ‡æ•°å­˜åˆ°ä¸€ä¸ªmapä¸­</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span><span class="number">+7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// æ±‚nä¸ªæ•°ä¹˜ç§¯çš„çº¦æ•°çš„ä¸ªæ•°,å¹¶å¯¹modå–ä½™</span></span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; primes;</span><br><span class="line">	<span class="keyword">while</span>(n--) &#123;</span><br><span class="line">		<span class="type">int</span> x;</span><br><span class="line">		cin&gt;&gt;x;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=x/i;i++) &#123;</span><br><span class="line">			<span class="keyword">while</span>(x%i==<span class="number">0</span>) &#123;</span><br><span class="line">				x/=i;</span><br><span class="line">				<span class="comment">// å¯¹è¿™nä¸ªæ•°çš„çº¦æ•°éƒ½ç”¨primesæ¥å­˜,æœ€åç»Ÿä¸€ç®—å‡ºçº¦æ•°ä¸ªæ•°</span></span><br><span class="line">				primes[i]++; </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// å¦‚æœxè¿˜å¤§äº1,æŠŠå‰©ä¸‹å¤§çš„é‚£ä¸ªè´¨å› æ•°ç»™åŠ ä¸Š</span></span><br><span class="line">		<span class="keyword">if</span>(x&gt;<span class="number">1</span>)</span><br><span class="line">			primes[x]++;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// primesä¸­å­˜å‚¨äº†æ‰€æœ‰çš„åº•æ•°å’Œå…¶å¯¹åº”çš„æŒ‡æ•°</span></span><br><span class="line">	ll res=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> prime:primes)</span><br><span class="line">		res=res*(prime.second<span class="number">+1</span>)%mod;</span><br><span class="line">	cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="43-çº¦æ•°ä¹‹å’Œ">4.3. çº¦æ•°ä¹‹å’Œ</span></h3><ul>
<li>åªè¦æˆ‘ä»¬èƒ½æ±‚è§£å‡ºä¸€ä¸ªæ•°åˆ†è§£è´¨å› æ•°çš„ç»“æœï¼Œå°±èƒ½æ±‚å¾—å…¶çº¦æ•°ä¹‹å’Œï¼ŒæŠŠnçš„æ‰€æœ‰çº¦æ•°å±•å¼€ï¼Œå…¬å¼å°±æ˜¯ä¸‹å›¾ï¼š</li>
</ul>
<p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231201152853841.png"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠŠå› å¼åˆ†è§£æ¯ä¸ªåŸºæ•°çš„åº•æ•°å’ŒæŒ‡æ•°å­˜åˆ°ä¸€ä¸ªmapä¸­</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span><span class="number">+7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// æ±‚nä¸ªæ•°ä¹˜ç§¯çš„çº¦æ•°çš„ä¸ªæ•°,å¹¶å¯¹modå–ä½™</span></span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; primes;</span><br><span class="line">	<span class="keyword">while</span>(n--) &#123;</span><br><span class="line">		<span class="type">int</span> x;</span><br><span class="line">		cin&gt;&gt;x;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=x/i;i++) &#123;</span><br><span class="line">			<span class="keyword">while</span>(x%i==<span class="number">0</span>) &#123;</span><br><span class="line">				x/=i;</span><br><span class="line">				<span class="comment">// å¯¹è¿™nä¸ªæ•°çš„çº¦æ•°éƒ½ç”¨primesæ¥å­˜,æœ€åç»Ÿä¸€ç®—å‡ºçº¦æ•°ä¸ªæ•°</span></span><br><span class="line">				primes[i]++; </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// å¦‚æœxè¿˜å¤§äº1,æŠŠå‰©ä¸‹å¤§çš„é‚£ä¸ªè´¨å› æ•°ç»™åŠ ä¸Š</span></span><br><span class="line">		<span class="keyword">if</span>(x&gt;<span class="number">1</span>)</span><br><span class="line">			primes[x]++;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// primesä¸­å­˜å‚¨äº†æ‰€æœ‰çš„åº•æ•°å’Œå…¶å¯¹åº”çš„æŒ‡æ•°</span></span><br><span class="line">	ll res=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> prime:primes) &#123;</span><br><span class="line">		<span class="type">int</span> p=prime.first; <span class="comment">// åº•æ•°</span></span><br><span class="line">		<span class="type">int</span> a=prime.second; <span class="comment">// æŒ‡æ•°</span></span><br><span class="line">		ll t=<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// æ¯ä¸€æ¬¡æä¸€ä¸ªpå‡ºæ¥</span></span><br><span class="line">        <span class="comment">// 1+p1(p1^0+p1^1+Â·Â·Â·+p1^(Î±1-1))</span></span><br><span class="line">		<span class="keyword">while</span>(a--)</span><br><span class="line">			t=(t*p<span class="number">+1</span>)%mod;</span><br><span class="line">		res=res*t%mod; <span class="comment">// ç»“æœåŒæ ·å¯¹modå–ä½™</span></span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;res;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2><span id="4-æœ€å¤§å…¬çº¦æ•°">4. æœ€å¤§å…¬çº¦æ•°</span></h2><ul>
<li><p>æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œä¹Ÿå«è¾—è½¬ç›¸é™¤æ³•</p>
</li>
<li><p>å¦‚æœaèƒ½é™¤dï¼Œbèƒ½é™¤dï¼Œé‚£ä¹ˆ(a+b)ä¹Ÿèƒ½æ•´é™¤dï¼Œæ¯”å¦‚6èƒ½è¢«2æ•´é™¤ï¼Œ14èƒ½è¢«2æ•´é™¤ï¼Œé‚£ä¹ˆ20èƒ½è¢«2æ•´é™¤ï¼Œç”šè€…è¿˜æœ‰ aÂ·x+bÂ·y èƒ½è¢«dæ•´é™¤</p>
</li>
<li><p>æ ¹æ®è¾—è½¬ç›¸é™¤æ³•ï¼Œaå’Œbçš„æœ€å¤§å…¬çº¦æ•°å°±ç­‰äºbå’Œa mod bçš„æœ€å¤§å…¬çº¦æ•°ã€‚æ€ä¹ˆæ¨çš„ï¼Ÿ</p>
</li>
<li><p>$a%b&#x3D;a-floor(a&#x2F;b)Ã—b$ ï¼Œå†™æˆ $a-cÃ—b$ï¼Œé‚£ä¹ˆ $(a,b)&#x3D;(b, a - c Ã— b)$</p>
</li>
<li><p>å¯¹äºå·¦ä¾§ï¼Œ$(a,b)$ï¼Œå‡è®¾ $d$ èƒ½æ•´é™¤ $a$ ï¼Œ$d$ ä¹Ÿèƒ½æ•´é™¤ $b$ï¼Œå¯¹äºå³ä¾§ï¼Œ$d$ èƒ½æ•´é™¤ $b$ï¼Œç°åœ¨åªéœ€è¦è¯æ˜ $d$ ä¹Ÿèƒ½æ•´é™¤ $a$ ï¼Œå°±èƒ½è¯´æ˜å·¦å³ä¸¤ä¾§ç­‰ä»·äº†ï¼Œ$d$ èƒ½æ•´é™¤ $a - c Ã— b$ï¼Œåªéœ€è¦åœ¨å³ä¾§åŠ ä¸Šä¸€ä¸ª $c Ã— b$ (ç›¸å½“äº $aÃ—x+bÃ—y$ )ï¼Œå°±èƒ½è¯´æ˜ $d$ èƒ½æ•´é™¤ $a$ äº†ï¼Œæ‰€ä»¥å·¦å³ä¸¤ä¾§ç­‰ä»·ã€‚è¯æ¯•ï¼Œ$(a,b)&#x3D;(b,a%b)$</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å½“b=0æ—¶,(a,0)çš„æœ€å¤§å…¬çº¦æ•°ä¸€å®šæ˜¯a,æ‰€ä»¥è¿”å›å€¼çš„ç¬¬äºŒé¡¹æ˜¯a</span></span><br><span class="line">	<span class="keyword">return</span> b?<span class="built_in">gcd</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2><span id="5-æ¬§æ‹‰å‡½æ•°">5. æ¬§æ‹‰å‡½æ•°</span></h2><blockquote>
<p>æ—¶é—´å¤æ‚åº¦$O(sqrt(n))$ï¼Œæ¥æºäºåˆ†è§£è´¨å› æ•°çš„$O(sqrt(n))$</p>
</blockquote>
<h3><span id="51-å®šä¹‰æ³•">5.1. å®šä¹‰æ³•</span></h3><ul>
<li>$Ï†(n)$è¡¨ç¤º1~nä¸­ä¸näº’è´¨çš„ä¸ªæ•°ï¼Œæ¯”å¦‚$Ï†(6)$ï¼Œ$[1,6]$ ä¸­æœ‰1,5ä¸6äº’è´¨ï¼ˆäº’è´¨ï¼šå…¬çº¦æ•°åªæœ‰1çš„ä¸¤ä¸ªæ•´æ•°ï¼Œå«åšäº’è´¨æ•´æ•°ï¼‰ï¼Œæ‰€ä»¥$Ï†(6)$&#x3D;2</li>
</ul>
<p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231201162530871.png" alt="image-20231201162530871"></p>
<ul>
<li>æ ¹æ®å®¹æ–¥åŸç†å¯ä»¥æ¨å¯¼ï¼Œå®¹æ–¥åŸç†ï¼š</li>
</ul>
<ol>
<li><p>ä» $[1,N]$ ä¸­å»æ‰ $p_1, p_2, â€¦ , p_k$ çš„æ‰€æœ‰å€æ•°ï¼Œè€Œ $[1,N]$ å½“ä¸­ $p_k$ çš„å€æ•°ç­‰äº$N-N&#x2F;p_1-N&#x2F;p_2-Â·Â·Â·-N&#x2F;p_k$ï¼Œæ­¤æ—¶æœ‰äº›æ•°å¯èƒ½æ—¢æ˜¯$p_1$çš„å€æ•°ï¼Œä¹Ÿæ˜¯$p_2$çš„å€æ•°ï¼Œå°±å¤šå»é™¤äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥æ­¤æ—¶è¿›è¡Œç¬¬äºŒæ­¥ï¼›</p>
</li>
<li><p>åŠ ä¸Šæ‰€æœ‰$p_iÃ—p_j$çš„å€æ•°ï¼Œiå’Œjæ˜¯1~Kä¸­ä»»æ„ä¸¤ä¸ªæ•°ï¼Œå¾—åˆ°ä¸‹å¼ï¼š</p>
<p>$N-N&#x2F;p_1-N&#x2F;p_2-Â·Â·Â·-N&#x2F;p_k+N&#x2F;p_1Ã—p_2+N&#x2F;p_1Ã—p_3+Â·Â·Â·N&#x2F;p_{k-1})Ã—p_k$</p>
</li>
<li><p>è¿™æ—¶å€™åˆä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªæ•°æ—¢æ˜¯$p_1$ã€$p_2$ï¼Œä¹Ÿæ˜¯$p_3$çš„å€å‘¢ï¼Ÿå®ƒå°±ä¼šè¢«p1å‡ä¸€æ¬¡ï¼Œp2å‡ä¸€æ¬¡ï¼Œp3å†å‡ä¸€æ¬¡ï¼Œå†åœ¨ç¬¬äºŒæ­¥ä¸­åŠ ä¸Šä¸‰æ¬¡ï¼Œæ‰€ä»¥ç¬¬ä¸‰æ­¥ï¼›è¿™ä¸ªæ—¶å€™ç›¸å½“äºåŠ å›æ¥äº†ï¼Œè€Œæˆ‘ä»¬æ˜¯æƒ³æŠŠå®ƒåˆ å»ï¼Œæ‰€ä»¥è¿˜è¦å‡å»æ‰€æœ‰piÃ—pjÃ—pkçš„å€æ•°ï¼Œå¾—åˆ°ä¸‹å¼ï¼š$N-N&#x2F;p1-N&#x2F;p2-Â·Â·Â·-N&#x2F;pk+N&#x2F;p1Ã—p2+N&#x2F;p1Ã—p3+Â·Â·Â·N&#x2F;p(k-1)Ã—pk-N&#x2F;p1Ã—p2Ã—p3-N&#x2F;p1Ã—p2Ã—p4-Â·Â·Â·-N&#x2F;p(k-2)Ã—p(k-1)Ã—pk$ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€åå¾—åˆ°çš„å…¬å¼å…¶å®å°±æ˜¯ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„å±•å¼€ï¼Œæ‰€ä»¥æ¬§æ‹‰å‡½æ•°å…¶å®å°±æ˜¯å®¹æ–¥åŸç†çš„å±•å¼€ï¼š</p>
</li>
</ol>
<p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231201163755176.png" alt="image-20231201163755176"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_ola</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> res=n;</span><br><span class="line">   	<span class="comment">// æ‰¾nçš„æ‰€æœ‰è´¨å› å­</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n/i;i ++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n%i==<span class="number">0</span>) &#123;</span><br><span class="line">			<span class="comment">// res=res*(1-1/a):è¿™æ˜¯æ¬§æ‹‰å…¬å¼</span></span><br><span class="line">			<span class="comment">// åƒä¸‹é¢è¿™ä¸ªå…¬å¼ä¸€æ ·è½¬æ¢æ˜¯ä¸ºäº†é¿å…å‡ºç°å°æ•°,å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ•´æ•°è¿ç®—,ä¿è¯åªæœ‰æ•´æ•°</span></span><br><span class="line">			res=res/i*(i<span class="number">-1</span>);</span><br><span class="line">			<span class="keyword">while</span>(n%i==<span class="number">0</span>)</span><br><span class="line">				n/=i;</span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(n&gt;<span class="number">1</span>)</span><br><span class="line">		res=res/n*(n<span class="number">-1</span>);</span><br><span class="line">	cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="52-ç­›æ³•">5.2. ç­›æ³•</span></h3><ul>
<li>åœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦æ±‚å‡º $[1,N]$ ä¸­æ¯ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°ï¼Œè¿™ç§æƒ…å†µä¸‹ç”¨å…¬å¼å°±éå¸¸çš„æ…¢ï¼Œå¯ä»¥å€ŸåŠ©ä¹‹å‰çº¿æ€§ç­›çš„æ€æƒ³ï¼Œç”¨ $O(n)$ çš„æ—¶é—´å¤æ‚åº¦æ±‚å‡ºæ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°ã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span><span class="number">+10</span>;</span><br><span class="line"><span class="type">int</span> primes[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="type">int</span> phi[N]; <span class="comment">// phi[i]:1~iä¸­æœ‰å¤šä¸ªæ•°å’Œiäº’æ–¥</span></span><br><span class="line">ll res;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨çº¿æ€§ç­›çš„è¿‡ç¨‹ä¸­æ±‚æ¬§æ‹‰å‡½æ•°</span></span><br><span class="line"><span class="function">ll <span class="title">get_eulers</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">	phi[<span class="number">1</span>]=<span class="number">1</span>; <span class="comment">// 1~1ä¸­å’Œ1äº’æ–¥çš„åªæœ‰è‡ªå·±</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++) &#123;</span><br><span class="line">		<span class="keyword">if</span>(!st[i]) &#123;</span><br><span class="line">			primes[cnt++]=i;</span><br><span class="line">			<span class="comment">// å¦‚æœiæ˜¯è´¨æ•°,é‚£ä¹ˆå‰i-1ä¸ªæ•°éƒ½å’Œiäº’è´¨</span></span><br><span class="line">			phi[i]=i<span class="number">-1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;primes[j]&lt;=n/i;j++) &#123;</span><br><span class="line">			st[primes[j]*i]=<span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%primes[j]==<span class="number">0</span>) &#123;</span><br><span class="line">				<span class="comment">// i mod pj==0æ—¶è¯´æ˜pjæ˜¯içš„è´¨å› å­</span></span><br><span class="line">				<span class="comment">// phi(pj*i)å°±ç­‰äºpj*phi(i)</span></span><br><span class="line">				phi[primes[j]*i]=primes[j]*phi[i];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// i mod pj!=0, pj ä¸€å®šæ˜¯ i*pj çš„è´¨å› å­</span></span><br><span class="line">			<span class="comment">// phi(pj*i)å°±ç­‰äºp(j-1)*phi(i)</span></span><br><span class="line">			phi[primes[j]*i]=phi[i]*(primes[j]<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	ll res=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">		res+=phi[i];</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// æ±‚1~nä¸­æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ</span></span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	cout&lt;&lt;<span class="built_in">get_eulers</span>(n)&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="53-æ¬§æ‹‰å®šç†">5.3. æ¬§æ‹‰å®šç†</span></h3><ul>
<li>å¦‚æœ $a$ ä¸ $n$ äº’è´¨ï¼Œé‚£ä¹ˆ $a^phi(n)\ mod\ n$ åŒä½™ $1$ï¼Œä¾‹å¦‚ï¼š$a&#x3D;5$, $n&#x3D;6$ æ—¶æœ‰ï¼š$5^phi(6) &#x3D; 5^2 &#x3D;25ï¼Œ25 mod 6 &#x3D;1</li>
</ul>
<p>â€‹		æ¬§æ‹‰å®šç†æ¨è®ºï¼šè‹¥ a^phi(p) mod p &#x3D;1ï¼Œå‡è®¾pæ˜¯è´¨æ•°ï¼Œåˆ™æœ‰ a^(p-1) mod p&#x3D;1ï¼Œè¿™ä¹Ÿæ˜¯è´¹é©¬(å°)å®šç†ã€‚å¦‚æœn&#x3D;5ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æŠŠ1å’Œ6è§†ä¸ºåŒæ ·çš„å€¼ï¼Œå› ä¸º1%5 &#x3D;&#x3D; 6%5 &#x3D;&#x3D; 1ã€‚</p>
<h2><span id="6-å¿«é€Ÿå¹‚">6. å¿«é€Ÿå¹‚</span></h2><blockquote>
<p>èƒ½åœ¨ $O(log^k)$ çš„æ—¶é—´ä¸‹å¿«é€Ÿæ±‚å‡º $a^k\ mod\ p$ çš„ç»“æœï¼Œå…¶ä¸­ $a,\ p,\ k&lt;&#x3D;10^9$</p>
</blockquote>
<ul>
<li>å¯¹äº $a^k\ mod\ p$ï¼Œå¿«é€Ÿå¹‚å°±æ˜¯é¢„è®¡ç®—å‡º $a^{(2^0)}\ mod\ p$ çš„ç»“æœã€ $a^{(2^1)}\ mod\ p$ çš„ç»“æœã€â€¦ ã€ $a^{2^{(log^k)}}\ mod\ p$ çš„ç»“æœï¼Œä¸€å…± $log^k$ ä¸ªæ•°ï¼Œå¦‚æœè¦æŠŠ $a^k$ ç»„åˆå‡ºæ¥ï¼Œå…¶å®å°±æ˜¯ä¸€ç§äºŒè¿›åˆ¶ä¼˜åŒ–</li>
<li>æ¯”å¦‚æˆ‘ä»¬è¦è®¡ç®— $4^5\ mod\ 10$ ï¼Œå°±é¢„ç®—å‡º $4^{2^0}\ mod\ 10$ã€ $4^{2^1}\ mod\ 10$ã€ $4^{2^2}\ mod\ 10$ çš„ç»“æœï¼Œ$5$ çš„äºŒè¿›åˆ¶åˆç­‰äº $(101)_2$ï¼Œæ‰€ä»¥å°±æ˜¯ $4^ {2^0} mod 10 Ã— 4^{2^2}\ mod\ 10$</li>
</ul>
<h3><span id="61-å¿«é€Ÿå¹‚">6.1. å¿«é€Ÿå¹‚</span></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> k,<span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(k) &#123;</span><br><span class="line">		<span class="comment">// å–2è¿›åˆ¶æœ€åä¸€ä½,å¦‚æœä¸º1,åˆ™ä¹˜ä»¥è¿™ä¸€ä½çš„ä½æƒ</span></span><br><span class="line">		<span class="keyword">if</span>(k&amp;<span class="number">1</span>)</span><br><span class="line">			res=(ll)res*a%p;</span><br><span class="line">		<span class="comment">// å»æ‰æœ€åä¸€ä½</span></span><br><span class="line">		k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">		a=(ll)a*a%p; <span class="comment">// ä½æƒæå‡</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="62-å¿«é€Ÿå¹‚æ±‚é€†å…ƒ">6.2. å¿«é€Ÿå¹‚æ±‚é€†å…ƒ</span></h3><blockquote>
<p>$a&#x2F;b &#x3D; aÃ—x\ (mod\ m)$ï¼Œæ‰¾åˆ°è¿™ä¸ª $x$ ï¼Œå°±å¯ä»¥æŠŠé™¤æ³•å˜ä¸ºä¹˜æ³•ï¼Œç­‰å¼ä¸¤ç«¯çº¦å» $a$ï¼Œå¾—åˆ° $bÃ—x&#x3D;1(mod\ m)$ï¼Œå³åªè¦æ‰¾åˆ°æ•°å­— $x$ ï¼Œä½¿å¾— $bÃ—x\ mod\ m$ çš„å€¼ç­‰äº $1$ï¼Œ$x$ å°±æ˜¯é€†å…ƒã€‚</p>
</blockquote>
<p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231205080313203.png" alt="image-20231205080313203"></p>
<ul>
<li>å¦‚æœ $p$ æ˜¯è´¨æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼å­ä¼šå˜æˆä¸€ä¸ªè´¹é©¬å®šç†ï¼Œæ‰€ä»¥ $b^{p-1}&#x3D;1(mod p)$ï¼ŒæŠŠ $b^(p-1)$ å†™æˆ $bÃ—b^(p-2)$ ï¼Œ é‚£ä¹ˆ $b^(p-2)$ å°±æ˜¯ $b\ mod\ p$ çš„é€†å…ƒï¼Œåˆå› ä¸ºæœ€å°çš„è´¨æ•°æ˜¯ $2$ ï¼Œæ‰€ä»¥ $p-2$ ä¸€å®šæ˜¯ $â‰¥0$ çš„ï¼Œæ‰€ä»¥æˆç«‹ã€‚æ‰€ä»¥é¢˜ç›®å˜æˆä¸€ä¸ªå¿«é€Ÿå¹‚ï¼Œæ±‚å– $b^{p-2}\ mod\ p$</li>
<li>æ³¨æ„ï¼šå¦‚æœ $p$ å’Œ $b$ ä¹‹é—´å­˜åœ¨å€æ•°å…³ç³»ï¼ˆä¸äº’è´¨ï¼‰çš„è¯ï¼Œé‚£ä¹ˆ $bÃ—x\ mod\ p$ ä¸€å®šç­‰äº $0$ ï¼Œæ­¤æ—¶é€†å…ƒæ— è§£ï¼›å½“æ²¡æœ‰å€æ•°å…³ç³»æ—¶ï¼Œä¸€å®šæ˜¯æœ‰è§£çš„ã€‚<strong>åªæœ‰å½“ä¿è¯ $p$ æ˜¯è´¨æ•°æ—¶ï¼Œæ‰èƒ½ä½¿ç”¨å¿«é€Ÿå¹‚æ±‚é€†å…ƒï¼</strong></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> k,<span class="type">int</span> p)</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(k) &#123;</span><br><span class="line">		<span class="comment">// å–2è¿›åˆ¶æœ€åä¸€ä½,å¦‚æœä¸º1,åˆ™ä¹˜ä»¥è¿™ä¸€ä½çš„ä½æƒ</span></span><br><span class="line">		<span class="keyword">if</span>(k&amp;<span class="number">1</span>)</span><br><span class="line">			res=(ll)res*a%p;</span><br><span class="line">		<span class="comment">// å»æ‰æœ€åä¸€ä½</span></span><br><span class="line">		k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">		a=(ll)a*a%p; <span class="comment">// ä½æƒæå‡</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">while</span>(n--) &#123;</span><br><span class="line">		<span class="type">int</span> a,p;</span><br><span class="line">		cin&gt;&gt;a&gt;&gt;p;</span><br><span class="line">		<span class="type">int</span> res=<span class="built_in">qmi</span>(a,p<span class="number">-2</span>,p);</span><br><span class="line">		<span class="comment">// å¦‚æœaæ˜¯pçš„å€æ•°,åˆ™æ²¡æœ‰é€†å…ƒ,å› ä¸º a*x mod pä¸€å®šç­‰äº0</span></span><br><span class="line">		<span class="keyword">if</span>(a%p)</span><br><span class="line">			cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			cout&lt;&lt;<span class="string">&quot;impossible&quot;</span>&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2><span id="7-æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•">7. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span></h2><h3><span id="71-è£´èœ€å®šç†">7.1. è£´èœ€å®šç†</span></h3><ul>
<li>å¯¹äºä»»æ„ä¸€å¯¹æ­£æ•´æ•° $a,b$ ï¼Œé‚£ä¹ˆä¸€å®šå­˜åœ¨éé›¶æ•´æ•° $x,y$ ï¼Œä½¿å¾— $aÃ—x+bÃ—y&#x3D;gcd(a,b)$ ï¼Œå¹¶ä¸” $a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°æ˜¯ $a$ å’Œ $b$ å‡‘å‡ºæ¥çš„æœ€å°çš„æ­£æ•´æ•°</li>
<li>å¦‚ä½•è¯æ˜ï¼Ÿ$gcd(a,b)$ æ˜¯ $a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°ï¼Œé‚£ä¹ˆ $a$ å’Œ $b$ çš„çº¿æ€§ç»„åˆä¸€å®šæ˜¯æœ€å¤§å…¬çº¦æ•°çš„å€æ•°ï¼Œé‚£ä¹ˆæœ€å°çš„å€æ•°å°±æ˜¯ $1$ å€å‘—ï¼Œæ‰€ä»¥ä¸€å®šèƒ½å‡‘å‡ºï¼š$aÃ—x+bÃ—y&#x3D;gcd(a,b)$</li>
</ul>
<h3><span id="72-æ‰©å±•æ¬§å‡ é‡Œå¾—">7.2. æ‰©å±•æ¬§å‡ é‡Œå¾—</span></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// å¦‚æœb=0,é‚£ä¹ˆgcd(a,b)==a,çº¿æ€§ç»„åˆå³æ˜¯(1,0)</span></span><br><span class="line">	<span class="keyword">if</span>(!b) &#123;</span><br><span class="line">		x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> d=<span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">	<span class="comment">// â‘ b*y+(a mod b)*x=gcd(a,b)</span></span><br><span class="line">	<span class="comment">// â‘¡åˆ a mod b=a-floor(a/b)*bâ†’è¯æ˜:å‡è®¾ræ˜¯a mod bçš„ä½™æ•°,ç°åœ¨æˆ‘ä»¬è¦æ±‚è¿™ä¸ªr,a/b=floor(a/b)+r,âˆ´r=a-floor(a/b)*b	</span></span><br><span class="line">	<span class="comment">// äºŒå¼ç›¸ç»“åˆ,æœ‰: a*x+b*(y-floor(a/b)*x)=gcd(a,b),å³xçš„ç³»æ•°ä¸å˜,ä½†æ˜¯yè¦å‡å»é‚£ä¸€å¨</span></span><br><span class="line">	y-=a/b*x;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">while</span>(n--) &#123;</span><br><span class="line">		<span class="type">int</span> a,b,x,y;</span><br><span class="line">		cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">		<span class="built_in">exgcd</span>(a,b,x,y);</span><br><span class="line">		cout&lt;&lt;x&lt;&lt;<span class="string">&#x27; &#x27;</span>&lt;&lt;y&lt;&lt;endl; <span class="comment">// æ³¨æ„:xå’Œyä¸å”¯ä¸€</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="73-åº”ç”¨çº¿æ€§åŒä½™æ–¹ç¨‹">7.3. ã€åº”ç”¨ã€‘çº¿æ€§åŒä½™æ–¹ç¨‹</span></h3><blockquote>
<p>ç»™å®š $a,b,m$ï¼Œæ±‚æ•´æ•° $x$ ä½¿å¾—  $aÃ—x\ mod\ m&#x3D;b$ï¼ˆå¦‚æœ $b$ ä¸º $1$ å°±æ˜¯æ±‚é€†å…ƒäº†æ˜¯å§ï¼Œå¦‚æœ $m$ å†ä¸ºè´¨æ•°ï¼Œå°±å¯ä»¥ç”¨å¿«é€Ÿå¹‚äº†ï¼‰ï¼Œæ³¨æ„ $x$ çš„è§£ä¸å”¯ä¸€ã€‚</p>
</blockquote>
<p>$$<br>ax\equiv b(mod\ m) \ ç­‰ä»·äºå­˜åœ¨æ•´æ•°yâˆˆZ,\ st. \ ax&#x3D;m*y+b \ ,å³mçš„è‹¥å¹²å€å†åŠ ä¸Šb<br>\<br>åŒ–ç®€å¾—\ ax-my&#x3D;b, \ æŠŠ-yä»¤æˆyâ€™ï¼Œå³æœ‰\ ax+myâ€™&#x3D;b, \ å°±å˜æˆäº†æ‰©å±•æ¬§å‡ é‡Œå¾—çš„æ–¹ç¨‹<br>\<br>æ‰€ä»¥æ ¹æ®æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥æ±‚å‡ºä¸€ç»„ç³»æ•°x,yâ€™ä½¿å¾—ax+myâ€™&#x3D;b, \ dæ˜¯æœ€å¤§å…¬çº¦æ•°<br>$$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!b) &#123;</span><br><span class="line">		x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> d=<span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">	y-=a/b*x;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">while</span>(n--) &#123;</span><br><span class="line">		<span class="comment">// a*x mod m =b</span></span><br><span class="line">		<span class="type">int</span> a,b,m;</span><br><span class="line">		cin&gt;&gt;a&gt;&gt;b&gt;&gt;m;</span><br><span class="line">		<span class="type">int</span> x,y;</span><br><span class="line">		<span class="type">int</span> d=<span class="built_in">exgcd</span>(a,m,x,y);</span><br><span class="line">		<span class="comment">// å¦‚æœbä¸æ˜¯dçš„å€æ•°æ–¹ç¨‹æ— è§£,å› ä¸ºa*xæ— æ³•é€šè¿‡%måŒä½™ç­‰äºb</span></span><br><span class="line">		<span class="keyword">if</span>(b%d)</span><br><span class="line">			cout&lt;&lt;<span class="string">&quot;impossible&quot;</span>&lt;&lt;endl;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="comment">// æ³¨æ„è¿™ä¸ªè§£ä¸å”¯ä¸€</span></span><br><span class="line">			<span class="comment">// å½“bæ˜¯dçš„å€æ•°æ—¶,æ–¹ç¨‹ä¸¤è¾¹åŒæ—¶åˆä¸€d,å¾—åˆ° a/d*x=b/d(mod m/d),ç”±äº</span></span><br><span class="line">			<span class="comment">// a/då’Œm/dæ˜¯äº’è´¨çš„,å¯ä»¥æ‰¾åˆ°a/dçš„é€†å…ƒx&#x27;,ä½¿å¾—(a/b)*x&#x27;=1(mod m/d)</span></span><br><span class="line">			<span class="comment">// æ‰€ä»¥è®© b/dä¹˜ä»¥è¿™ä¸ªç±³è¿œx&#x27;å¾—åˆ°x*(b/d),è¿™å°±æ˜¯xçš„ä¸€ä¸ªç‰¹è§£</span></span><br><span class="line">			cout&lt;&lt;(ll)x*(b/d)%m&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="74-åº”ç”¨ä¸­å›½å‰©ä½™å®šç†">7.4. ã€åº”ç”¨ã€‘ä¸­å›½å‰©ä½™å®šç†</span></h3><p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231205095348192.png" alt="image-20231205095348192"></p>
<ul>
<li>æ³¨æ„ï¼š$m_1,\ Â·Â·Â·\ ,m_n$ ä¹‹é—´æ˜¯ä¸¤ä¸¤äº’è´¨çš„</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">exgcd</span><span class="params">(LL a,LL b,LL &amp;x,LL &amp;y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!b)&#123;</span><br><span class="line">		x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	LL d=<span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">	y-=a/b*x;</span><br><span class="line">	<span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	LL x=<span class="number">0</span>,m1,a1;</span><br><span class="line">	cin&gt;&gt;a1&gt;&gt;m1;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">		LL m2,a2;</span><br><span class="line">		cin&gt;&gt;a2&gt;&gt;m2;</span><br><span class="line">		LL k1,k2;</span><br><span class="line">		LL d=<span class="built_in">exgcd</span>(a1,a2,k1,k2);</span><br><span class="line">		<span class="keyword">if</span>((m2-m1)%d)&#123;</span><br><span class="line">			x=<span class="number">-1</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ›´æ–°çŠ¶æ€</span></span><br><span class="line">		k1*=(m2-m1)/d;</span><br><span class="line">		LL t=a2/d;</span><br><span class="line">		<span class="comment">// å°†è§£å˜æˆä¸€ä¸ªæœ€å°çš„æ­£æ•´æ•°è§£</span></span><br><span class="line">		k1=(k1%t+t)%t;</span><br><span class="line">		</span><br><span class="line">		x=k1*a1+m1;</span><br><span class="line">		<span class="comment">// æ›´æ–°aå’Œm,kåªæ˜¯ä¸ªå˜é‡,ä¸ç”¨ç®¡,å–ä½™çš„æ—¶å€™ä¼šè‡ªåŠ¨æ¶ˆå¤±</span></span><br><span class="line">		m1=k1*a1+m1;</span><br><span class="line">		a1=<span class="built_in">abs</span>(a1/d*a2);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(x!=<span class="number">-1</span>) x=(m1%a1+a1)%a1;</span><br><span class="line">	</span><br><span class="line">	cout&lt;&lt;x&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2><span id="8-é«˜æ–¯æ¶ˆå…ƒ">8. é«˜æ–¯æ¶ˆå…ƒ</span></h2><h3><span id="81-é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„">8.1. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„</span></h3><p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231205234751191.png" alt="image-20231205234751191"></p>
<ul>
<li>è¿™ç§é¢˜ä¸€èˆ¬æœ‰ $SPJ$ ä¼˜åŒ–ï¼Œå³ $0.00$ å’Œ $-0.00$ éƒ½è®¤ä¸ºæ˜¯ $0$ï¼Œå³éƒ½è®¤ä¸ºæ˜¯ç›¸åŒçš„å†…å®¹ï¼Œå› ä¸ºåœ¨æ•°å­¦ä¸Š $+0$ å’Œ $-0$ ä»£è¡¨çš„æ¦‚å¿µå’Œæ„ä¹‰éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span> <span class="comment">// fabs() = float abs = æµ®ç‚¹æ•°çš„ç»å¯¹å€¼ï¼Œç›¸å¯¹åº”çš„ï¼Œæ•´æ•°çš„ç»å¯¹å€¼å³ä¸ºabs()</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é«˜æ–¯æ¶ˆå…ƒçš„å››éƒ¨æ“ä½œ:</span></span><br><span class="line"><span class="comment">// 1:æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œ(ä¸ºäº†ä»£ç çš„ç¨³å®šæ€§)</span></span><br><span class="line"><span class="comment">// 2:å°†è¯¥è¡Œç§»åˆ°æœ€ä¸Šé¢</span></span><br><span class="line"><span class="comment">// 3:å°†æ”¹è¡Œç¬¬ä¸€ä¸ªæ•°å˜ä¸º1</span></span><br><span class="line"><span class="comment">// 4:å°†æœ€ä¸Šé¢ä¸€è¡Œä¸‹é¢çš„æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—å˜ä¸º0</span></span><br><span class="line"><span class="comment">// ä»¥ä¸Š4æ­¥å‡å¯ç”¨åˆç­‰è¡Œå˜æ¢å®Œæˆ</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> eps = <span class="number">1e-8</span>; <span class="comment">// é˜²æ­¢å‡ºç°ç²¾åº¦é—®é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="type">double</span> a[N][N];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> c = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(; c &lt; n; c++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">int</span> t = r;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = r; i &lt; n; i ++ ) <span class="comment">// ç¬¬ä¸€æ­¥ï¼Œæ‰¾ç»å¯¹å€¼æœ€å¤§çš„è¡Œ</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">fabs</span>(a[i][c]) &gt; <span class="built_in">fabs</span>(a[t][c]))</span><br><span class="line">				t = i; </span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">fabs</span>(a[t][c]) &lt; eps) <span class="keyword">continue</span>; <span class="comment">// ä»£è¡¨è¿™ä¸€åˆ—å·²ç»è¢«å¤„ç†è¿‡äº†</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = c; i &lt;= n; i++) <span class="comment">// ç¬¬äºŒæ­¥ </span></span><br><span class="line">			<span class="built_in">swap</span>(a[t][i], a[r][i]); <span class="comment">// å°†è¿™ä¸€è¡Œè°ƒåˆ°æœ€ä¸Šé¢</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = n; i &gt;= c; i--) <span class="comment">// ç¬¬ä¸‰æ­¥</span></span><br><span class="line">			a[r][i] /= a[r][c]; <span class="comment">// è¦å€’ç€ç®—ï¼Œå¦åˆ™ä¼šå½±å“åé¢çš„æ•°</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = r + <span class="number">1</span>; i &lt; n; i++) <span class="comment">// ç¬¬å››æ­¥</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">fabs</span>(a[i][c]) &gt; eps)  <span class="comment">// å¦‚æœæ˜¯0å°±ä¸ç”¨æ“ä½œäº†</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = n; j &gt;= c; j--)</span><br><span class="line">				&#123;</span><br><span class="line">					a[i][j] -= a[r][j] * a[i][c];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		r++;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(r &lt; n) <span class="comment">// æ–¹ç¨‹æ•° &lt; n</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = r; i &lt; n; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">fabs</span>(a[i][n]) &gt; eps) <span class="comment">// 0 != 0</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">2</span>; <span class="comment">// æ— è§£</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// æ— æ•°è§£, 0=0</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) <span class="comment">// æœ‰è§£ä»ä¸‹å¾€ä¸Šå›ä»£</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			a[i][n] -= a[i][j] * a[j][n];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n + <span class="number">1</span>; j ++ )</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>, &amp;a[i][j]);</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> t = <span class="built_in">gauss</span>();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(t == <span class="number">0</span>)  <span class="comment">// æœ‰å”¯ä¸€è§£</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// æœ€åè¾“å‡ºçš„å°±æ˜¯æ¯ä¸ªæœªçŸ¥è§£çš„å€¼:&gt;</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">fabs</span>(a[i][n]) &lt; eps) a[i][n] = <span class="number">0.00</span>; <span class="comment">// é¿å…è¾“å‡º-0.00</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, a[i][n]);</span><br><span class="line">			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(t == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">&quot;Infinite group solutions&quot;</span>); <span class="comment">// æ— æ•°è§£</span></span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;No solution&quot;</span>); <span class="comment">// æ— è§£</span></span><br><span class="line">	</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<h3><span id="82-é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„">8.2. é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„</span></h3><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231205235928312.png" alt="image-20231205235928312" style="zoom:80%;">

<ul>
<li>ç³»æ•°å’Œå¸¸æ•°çš„å€¼éƒ½ä¸º $0$ æˆ– $1$ ï¼Œæ¯ä¸ªæœªçŸ¥æ•°çš„å–å€¼ä¹Ÿä¸º $0$ æˆ– $1$ ï¼Œæ–¹ç¨‹ä¸­é—´æ˜¯å¼‚æˆ–è¿ç®—ï¼š</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¸å¿ƒæ€æƒ³:å¼‚æˆ–â†’ä¸è¿›ä½çš„åŠ æ³•</span></span><br><span class="line"><span class="comment">// ç­‰å¼ä¸ç­‰å¼ä¹‹é—´çš„å¼‚æˆ–è¦ä¸€èµ·è¿›è¡Œæ‰èƒ½ä¿è¯ç­‰å¼å·¦å³ä¸¤è¾¹ä¾ç„¶æ˜¯ç›¸ç­‰å…³ç³»</span></span><br><span class="line"><span class="comment">// a^b^c=x,d^f=y,åˆ™æœ‰a^b^d^c^f=x^y</span></span><br><span class="line"><span class="comment">// 1. å·¦ä¸‹è§’æ¶ˆ0</span></span><br><span class="line"><span class="comment">// 1.1 æšä¸¾åˆ—</span></span><br><span class="line"><span class="comment">// 1.2 æ‰¾ç¬¬ä¸€ä¸ªéé›¶è¡Œ</span></span><br><span class="line"><span class="comment">// 1.3 äº¤æ¢</span></span><br><span class="line"><span class="comment">// 1.4 æŠŠåŒåˆ—ä¸‹é¢è¡Œæ¶ˆé›¶(å¼‚æˆ–)</span></span><br><span class="line"><span class="comment">// 2. åˆ¤æ–­3ç§æƒ…å†µ</span></span><br><span class="line"><span class="comment">// 2.1 å”¯ä¸€è§£</span></span><br><span class="line"><span class="comment">// 2.2 ç§©&lt;n</span></span><br><span class="line"><span class="comment">// 2.2.1 æœ‰çŸ›ç›¾ æ— è§£</span></span><br><span class="line"><span class="comment">// 2.2.2 æ— çŸ›ç›¾ æ— ç©·å¤šè§£</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>; <span class="comment">// æœ€å¤š110ä¸ªç³»æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> a[N][N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">gauss</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> c,r;</span><br><span class="line">	<span class="keyword">for</span>(c=<span class="number">0</span>,r=<span class="number">0</span>;c&lt;n;c++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// æ‰¾ä¸»å…ƒ</span></span><br><span class="line">		<span class="type">int</span> t=<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=r;i&lt;n;i++)</span><br><span class="line">			<span class="keyword">if</span>(a[i][c])</span><br><span class="line">			&#123;</span><br><span class="line">				t=i;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">if</span>(t==<span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="comment">// äº¤æ¢ä¸»å…ƒè¡Œ</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=c;j&lt;=n;j++) <span class="built_in">swap</span>(a[r][j],a[t][j]);</span><br><span class="line">		<span class="comment">// å·¦ä¸‹è§’æ¶ˆ</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=r<span class="number">+1</span>;i&lt;n;i++)</span><br><span class="line">			<span class="keyword">if</span>(a[i][c])<span class="comment">//æ¼äº†</span></span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j=n;j&gt;=c;j--)<span class="comment">//æ¼äº†</span></span><br><span class="line">					a[i][j] ^= a[r][j];</span><br><span class="line">		r++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// åˆ¤æ–­</span></span><br><span class="line">	<span class="keyword">if</span>(r&lt;n)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=r;i&lt;n;i++) <span class="comment">// i=r</span></span><br><span class="line">			<span class="keyword">if</span>(a[i][n])</span><br><span class="line">				<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// æ¶ˆå³ä¸Šè§’</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">+1</span>;j&lt;n;j++)</span><br><span class="line">			<span class="comment">//å¦‚æœæ˜¯0 å°±ä¸ç”¨ä¸‹é¢çš„a[j][j] æ¥^a[i][j]äº†</span></span><br><span class="line">			<span class="comment">//å¦‚æœä¸æ˜¯0 æ‰éœ€è¦ç”¨ç¬¬jè¡Œç¬¬jåˆ—a[j][j]æ¥^ç¬¬iè¡Œç¬¬jåˆ—a[i][j] </span></span><br><span class="line">			<span class="comment">//è¿›è€Œè¿›è¡Œæ•´è¡Œrow[i]^row[j] é—´æ¥å¯¼è‡´ a[i][n]^a[j][n]</span></span><br><span class="line">			<span class="keyword">if</span>(a[i][j])</span><br><span class="line">				a[i][n]^=a[j][n];</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=n;j++)</span><br><span class="line">			cin &gt;&gt; a[i][j];</span><br><span class="line">	<span class="type">int</span> t = <span class="built_in">gauss</span>();</span><br><span class="line">	<span class="keyword">if</span>(t==<span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) cout &lt;&lt; a[i][n] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">&quot;Multiple sets of solutions&quot;</span>);</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;No solution&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2><span id="9-ç»„åˆæ•°å­¦">9. ç»„åˆæ•°å­¦</span></h2><h3><span id="91-ç»„åˆæ•°">9.1. ç»„åˆæ•°</span></h3><h4><span id="911-æœ´ç´ æ³•">9.1.1. æœ´ç´ æ³•</span></h4><blockquote>
<p>æ—¶é—´å¤æ‚åº¦ $O(n^2)$</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span><span class="number">+10</span>;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–Cæ•°ç»„</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ä»0å¼€å§‹èµ‹å€¼,æ˜¯ä¸ºäº†è®©C11=C[0][0]+c[0][1]==1,æ­£ç¡®çš„å¾—åˆ°1</span></span><br><span class="line">	<span class="comment">// å…¶å®å°±æ˜¯æŠŠC[N][1~N]å…¨éƒ¨ç®—å‡ºæ¥äº†è€Œå·²</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;N;i++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=i;j++) &#123;</span><br><span class="line">			<span class="keyword">if</span>(!j)</span><br><span class="line">				c[i][j]=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				c[i][j]=(c[i<span class="number">-1</span>][j]+c[i<span class="number">-1</span>][j<span class="number">-1</span>])%mod;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4><span id="912-å¿«é€Ÿå¹‚">9.1.2. å¿«é€Ÿå¹‚</span></h4><blockquote>
<p>æ—¶é—´å¤æ‚åº¦ $O(aÃ—log^{mod})$</p>
</blockquote>
<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206090536947.png" alt="image-20231206090536947" style="zoom:80%;">

<ul>
<li>ä¸‰ä¸ªé˜¶ä¹˜çº§åˆ«çš„æ•°éƒ½å¯ä»¥ç”¨å¿«é€Ÿå¹‚è¿…é€Ÿç®—å‡ºï¼Œåœ¨å¯¹ç»„åˆæ•°è¿›è¡Œè¿ç®—æ—¶ï¼Œæˆ‘ä»¬è¦å¯¹ç»„åˆæ•°è¿›è¡Œæ¨¡è¿ç®—ï¼Œç›´æ¥ç”¨é™¤æ³•æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºé™¤æ³•å¾—åˆ°çš„ç»“æœä¸ä¸€å®šæ€»ä¸ºæ•´æ•°ï¼ˆå¯èƒ½æ˜¯æµ®ç‚¹æ•°ï¼‰ï¼Œæ­¤æ—¶å–æ¨¡å°±æ²¡æœ‰æ„ä¹‰ï¼Œéœ€è¦æ‰¾åˆ°åˆ†æ¯çš„ä¹˜æ³•é€†å…ƒï¼Œç„¶åå°†é™¤æ³•è½¬æ¢ä¸ºä¹˜æ³•ï¼Œå¿«é€Ÿå¹‚æ±‚é€†å…ƒä¸å°±æ˜¯è´¹é©¬å°å®šç†å—ï¼Œæ³¨æ„<strong>æ¨¡æ•°å¿…é¡»æ˜¯è´¨æ•°</strong>ï¼š</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; PII;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> mod=<span class="number">1e9</span><span class="number">+7</span>; <span class="comment">// è¿™æ˜¯ä¸€ä¸ªè´¨æ•°,æ‰€ä»¥ä¸2~1e9+6éƒ½äº’è´¨</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span><span class="number">+10</span>; <span class="comment">// æ•°å­—èŒƒå›´</span></span><br><span class="line">ll fac[N]; <span class="comment">// å­˜å‚¨é˜¶ä¹˜,åŸºäºæ•°ç»„å®ç°è®°å¿†åŒ–</span></span><br><span class="line">ll infac[N]; <span class="comment">// å­˜å‚¨i!çš„é€†å…ƒ,infac[i]=(i!)^(-1) mod p</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¿«é€Ÿå¹‚æ¨¡æ¿</span></span><br><span class="line"><span class="function">ll <span class="title">qmi</span><span class="params">(ll a,ll k,ll p)</span> </span>&#123;</span><br><span class="line">	ll res=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(k) &#123;</span><br><span class="line">		<span class="keyword">if</span>(k&amp;<span class="number">1</span>==<span class="number">1</span>)</span><br><span class="line">			res=res*a%p;</span><br><span class="line">		k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">		a=a*a%p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	fac[<span class="number">0</span>]=infac[<span class="number">0</span>]=<span class="number">1</span>; <span class="comment">// 0çš„é˜¶ä¹˜ä»¥åŠé€†å…ƒéƒ½æ˜¯1</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++) &#123;</span><br><span class="line">		fac[i]=fac[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">		infac[i]=(ll)infac[i<span class="number">-1</span>]*<span class="built_in">qmi</span>(i,mod<span class="number">-2</span>,mod)%mod; <span class="comment">// æ ¹æ®è´¹é©¬å°å®šç†æ±‚åˆ°i!é€†å…ƒ</span></span><br><span class="line">	&#125;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">while</span>(n--) &#123;</span><br><span class="line">		<span class="type">int</span> a,b;</span><br><span class="line">		cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">		<span class="comment">// cab=a!/(b!)*(a-b)!</span></span><br><span class="line">		cout&lt;&lt;(ll)fac[a]*infac[b]%mod*infac[a-b]%mod&lt;&lt;endl; <span class="comment">// é€šè¿‡ä¹˜æ³•é€†å…ƒè½¬æ¢ä¸ºä¹˜æ³•è¿ç®—</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4><span id="913-å¢å¡æ–¯å®šç†">9.1.3. å¢å¡æ–¯å®šç†</span></h4><blockquote>
<p>æ—¶é—´å¤æ‚åº¦ $O(plog_pN)$</p>
</blockquote>
<ul>
<li>å¯¹ä»»æ„éè´Ÿæ•´æ•° $a,b$ å’Œ**è´¨æ•°$p$**ï¼Œæœ‰ï¼š</li>
<li>å°† $m$ å’Œ $n$ ç”¨ $p$ è¿›åˆ¶è¡¨ç¤ºï¼Œå¤æ‚åº¦ä¸º $O(log_pn)$ï¼Œå¦‚æœå†ç”¨å¿«é€Ÿå¹‚æ±‚é€†å…ƒè®¡ç®—ç»„åˆæ•°ï¼Œå¤æ‚åº¦ä¸º$O(p)$ï¼Œæ•…æ€»æ—¶é—´å¤æ‚åº¦ä¸º$O(plog_pN)$ï¼Œè¿™é‡Œçš„ $N$ æ˜¯ $a,b$ çš„æ—¶é—´å¤æ‚åº¦çº¦ä¸º$10^{18}$ï¼Œå¦‚æœé¢„å¤„ç†é˜¶ä¹˜å’Œé˜¶ä¹˜é€†å…ƒï¼Œæ—¶é—´å¤æ‚åº¦èƒ½ä¸‹é™è‡³$O(p+log_pN)$</li>
</ul>
<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206093200137.png" alt="image-20231206093200137" style="zoom:80%;">

<ul>
<li>å…¶è¯æ˜éœ€è¦ç”¨åˆ°ä¸¤ä¸ªé‡è¦ç­‰å¼ï¼Œè¿™é‡Œä¸å†è¯æ˜ï¼š</li>
</ul>
<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206093244681.png" alt="image-20231206093244681" style="zoom:80%;">

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">qmi</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> k,<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(k)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(k&amp;<span class="number">1</span>)res = (LL)res*a%p;</span><br><span class="line">		a = (LL)a*a%p;</span><br><span class="line">		k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> p)</span><span class="comment">//è‡ªå˜é‡ç±»å‹int</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b&gt;a)<span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//æ¼äº†è¾¹ç•Œæ¡ä»¶</span></span><br><span class="line">	<span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// a!/(b!(a-b)!) = (a-b+1)*...*a / b! åˆ†å­æœ‰bé¡¹</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j=a;i&lt;=b;i++,j--)<span class="comment">//i&lt;=bè€Œä¸æ˜¯&lt;</span></span><br><span class="line">	&#123;</span><br><span class="line">		res = (LL)res*j%p;</span><br><span class="line">		res = (LL)res*<span class="built_in">qmi</span>(i,p<span class="number">-2</span>,p)%p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¯¹å…¬å¼æ•²</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">lucas</span><span class="params">(LL a,LL b,<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(a&lt;p &amp;&amp; b&lt;p)<span class="keyword">return</span> <span class="built_in">C</span>(a,b,p);<span class="comment">//lucasé€’å½’ç»ˆç‚¹æ˜¯C_&#123;bk&#125;^&#123;ak&#125;</span></span><br><span class="line">	<span class="keyword">return</span> (LL)<span class="built_in">C</span>(a%p,b%p,p)*<span class="built_in">lucas</span>(a/p,b/p,p)%p;<span class="comment">//a%påè‚¯å®šæ˜¯&lt;pçš„,æ‰€ä»¥å¯ä»¥ç”¨C(),ä½†a/påä¸ä¸€å®š&lt;p æ‰€ä»¥ç”¨lucasç»§ç»­é€’å½’</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="keyword">while</span>(n--)</span><br><span class="line">	&#123;</span><br><span class="line">		LL a,b;</span><br><span class="line">		<span class="type">int</span> p;</span><br><span class="line">		cin &gt;&gt; a &gt;&gt; b &gt;&gt; p;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">lucas</span>(a,b,p) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4><span id="914-çº¿æ€§ç­›é«˜ç²¾ä¹˜">9.1.4. çº¿æ€§ç­›+é«˜ç²¾ä¹˜</span></h4><blockquote>
<p>æ—¶é—´å¤æ‚åº¦è¿‘ä¼¼ $O(n)$</p>
</blockquote>
<ul>
<li>é¢˜ç›®å˜å¾—æ›´åŠ ç®€å•ç²—æš´ï¼Œå®ç°æ–¹æ³•ï¼šç”±äº $a$ å’Œ $b$ çš„æœ€å¤§å–å€¼æ˜¯ $5000$ï¼Œæ‰€ä»¥ç”¨çº¿æ€§ç­›åœ¨ $[1,5000]$ çš„èŒƒå›´å†…ç­›é€‰å‡ºè´¨æ•°ï¼Œæ±‚æ¯ä¸ªè´¨æ•°çš„æ¬¡æ•°ï¼Œå†ç”¨é«˜ç²¾åº¦ä¹˜æ³•æŠŠæ‰€æœ‰è´¨å› å­ä¹˜ä¸Šï¼š</li>
</ul>
<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206144822955.png" alt="image-20231206144822955" style="zoom:80%;">

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> primes[N],cnt; <span class="comment">// primes[N]:ä¾æ¬¡å­˜æ”¾1~Nä¸­å‡ºç°çš„è´¨æ•°</span></span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> st[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_primes</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!st[i])primes[cnt++]=i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;primes[j]*i&lt;=n;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			st[primes[j]*i]=<span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%primes[j]==<span class="number">0</span>)</span><br><span class="line">				<span class="keyword">break</span>; <span class="comment">// ==0æ¯æ¬¡æ¼</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹pçš„å„ä¸ª&lt;=açš„æ¬¡æ•°ç®—æ•´é™¤ä¸‹å–æ•´å€æ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> res =<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(n)</span><br><span class="line">	&#123;</span><br><span class="line">		res+=n/p;</span><br><span class="line">		n/=p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é«˜ç²¾åº¦ä¹˜</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">mul</span><span class="params">(vector&lt;<span class="type">int</span>&gt; a, <span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; c;</span><br><span class="line">	<span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i ++ )</span><br><span class="line">	&#123;</span><br><span class="line">		t += a[i] * b;</span><br><span class="line">		c.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">		t /= <span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (t)</span><br><span class="line">	&#123;</span><br><span class="line">		c.<span class="built_in">push_back</span>(t % <span class="number">10</span>);</span><br><span class="line">		t /= <span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// while(C.size()&gt;1 &amp;&amp; C.back()==0) C.pop_back();//è€ƒè™‘b==0æ—¶æ‰æœ‰popå¤šä½™çš„0 b!=0ä¸éœ€è¦è¿™è¡Œ</span></span><br><span class="line">	<span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> a,b;</span><br><span class="line">	cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">	<span class="built_in">get_primes</span>(a);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;cnt;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">int</span> p = primes[i];</span><br><span class="line">		sum[i] = <span class="built_in">get</span>(a,p)-<span class="built_in">get</span>(a-b,p)-<span class="built_in">get</span>(b,p); <span class="comment">// æ˜¯a-bä¸æ˜¯b-a</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; res;</span><br><span class="line">	res.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cnt; i ++ )</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; sum[i]; j ++ ) <span class="comment">// primes[i]çš„æ¬¡æ•°</span></span><br><span class="line">			res = <span class="built_in">mul</span>(res, primes[i]);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = res.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i -- ) </span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, res[i]);</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3><span id="92-å¡ç‰¹å…°æ•°">9.2. å¡ç‰¹å…°æ•°</span></h3><p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206150423021.png" alt="image-20231206150423021"></p>
<ul>
<li>è‹¥æŠŠ $0$ å’Œ $1$ ç½®äºåæ ‡è½´ä¸­ï¼Œèµ·ç‚¹å®šäºåŸç‚¹ï¼Œè‹¥ $0$ è¡¨ç¤ºå‘å³èµ°ï¼Œ$1$ è¡¨ç¤ºå‘ä¸Šèµ°ï¼Œé‚£ä¹ˆä»»ä½•å‰ç¼€ä¸­ $0$ çš„ä¸ªæ•°ä¸å°‘äº $1$ çš„ä¸ªæ•°å°±è½¬æ¢ä¸ºï¼šå¯¹äºè·¯å¾„ä¸Šçš„ä»»æ„ä¸€ç‚¹ï¼Œæ¨ªåæ ‡å¤§äºç­‰äºçºµåæ ‡ï¼Œé¢˜ç›®æ‰€æ±‚å³ä¸ºè¿™æ ·çš„åˆæ³•è·¯å¾„æ•°é‡ï¼š</li>
</ul>
<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/6828_9476d97655-Catalan.png" alt="Catalan.png" style="zoom: 50%;">

<ul>
<li>ç”±å›¾å¯çŸ¥ï¼Œä»»ä½•ä¸€æ¡ä¸åˆæ³•çš„è·¯å¾„ï¼ˆé»‘è‰²è·¯å¾„ï¼‰ï¼Œéƒ½å¯¹åº”ä¸€æ¡ä» $(0,0)$ èµ°åˆ° $(n-1,n+1)$ çš„è·¯å¾„ï¼ˆç°è‰²è·¯å¾„ï¼‰ï¼Œè€Œä»»ä½•ä¸€æ¡ä» $(0,0)$ èµ°åˆ° $(n-1,n+1)$ çš„è·¯å¾„ï¼Œä¹Ÿå¯¹åº”ä¸€æ¡ä»$(0,0)$ èµ°åˆ° $(n,n)$ çš„ä¸åˆæ³•è·¯å¾„ï¼š$ ans&#x3D;C_{2n}n-C_{2n}{n-1}&#x3D;C_{2n}n&#x2F;n+1$</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">200010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> fact[N], infact[N]; <span class="comment">// fact[i]:i!çš„é˜¶ä¹˜,infact[i]:i!é˜¶ä¹˜é€†å…ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ksm</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> res = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (k) &#123;</span><br><span class="line">		<span class="keyword">if</span> (k &amp; <span class="number">1</span>) res = (LL)res * a % mod;</span><br><span class="line">		a = (LL)a * a % mod;</span><br><span class="line">		k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fact[<span class="number">0</span>] = infact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">		fact[i] = (LL)fact[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">		infact[i] = (LL)infact[i - <span class="number">1</span>] * <span class="built_in">ksm</span>(i, mod - <span class="number">2</span>) % mod;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">init</span>();</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="type">int</span> res = (LL)fact[<span class="number">2</span> * n] * infact[n] % mod * infact[n] % mod * <span class="built_in">ksm</span>(n + <span class="number">1</span>, mod - <span class="number">2</span>) % mod;</span><br><span class="line">	cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2><span id="10-å®¹æ–¥åŸç†">10. å®¹æ–¥åŸç†</span></h2><ul>
<li>æ³¨æ„æ¬§æ‹‰å‡½æ•°çš„æ¨å¯¼è¿ç”¨åˆ°äº†å®¹æ–¥åŸç†ï¼Œæ¬§æ‹‰å‡½æ•°æ±‚å–çš„æ˜¯ $[1,n]$ å½“ä¸­ä¸ $n$ äº’è´¨çš„æ•°çš„ä¸ªæ•°ï¼š</li>
</ul>
<p><img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206152700721.png" alt="image-20231206152700721"></p>
<ul>
<li>æ¯”å¦‚ $n&#x3D;10,\ p1&#x3D;2,\ p2&#x3D;3$ï¼Œæ±‚$[1,10]$ä¸­æ»¡è¶³èƒ½æ•´é™¤ $p_1$ æˆ– $p_2$ çš„ä¸ªæ•°å³ï¼š$2,\ 3,\ 4,\ 6,\ 8,\ 9,\ 10$ å…± $7$ ä¸ª</li>
</ul>
<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206153027100.png" alt="image-20231206153027100" style="zoom:80%;">

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">20</span>;</span><br><span class="line"><span class="type">int</span> p[N], n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) cin &gt;&gt; p[i];</span><br><span class="line">	<span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">	<span class="comment">// æšä¸¾ä»1 åˆ° 1111...(mä¸ª1)çš„æ¯ä¸€ä¸ªé›†åˆçŠ¶æ€,(è‡³å°‘é€‰ä¸­ä¸€ä¸ªé›†åˆ)</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="number">1</span> &lt;&lt; m; i++) &#123;</span><br><span class="line">		<span class="type">int</span> t = <span class="number">1</span>; <span class="comment">// é€‰ä¸­é›†åˆå¯¹åº”è´¨æ•°çš„ä¹˜ç§¯</span></span><br><span class="line">		<span class="type">int</span> s = <span class="number">0</span>; <span class="comment">// é€‰ä¸­çš„é›†åˆæ•°é‡</span></span><br><span class="line">		<span class="comment">// æšä¸¾å½“å‰çŠ¶æ€çš„æ¯ä¸€ä½</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++)&#123;</span><br><span class="line">			<span class="comment">// é€‰ä¸­ä¸€ä¸ªé›†åˆ</span></span><br><span class="line">			<span class="keyword">if</span>(i &gt;&gt; j &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="comment">// ä¹˜ç§¯å¤§äºn,åˆ™n/t = 0,è·³å‡ºè¿™è½®å¾ªç¯</span></span><br><span class="line">				<span class="keyword">if</span>((LL)t * p[j] &gt; n) &#123;    </span><br><span class="line">					t = <span class="number">-1</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				s++; <span class="comment">// æœ‰ä¸€ä¸ª1,é›†åˆæ•°é‡+1</span></span><br><span class="line">				t *= p[j];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(t == <span class="number">-1</span>) </span><br><span class="line">			<span class="keyword">continue</span>;  	</span><br><span class="line">		<span class="keyword">if</span>(s &amp; <span class="number">1</span>) </span><br><span class="line">			res += n / t; <span class="comment">// é€‰ä¸­å¥‡æ•°ä¸ªé›†åˆ, åˆ™ç³»æ•°åº”è¯¥æ˜¯1, n/tä¸ºå½“å‰è¿™ç§çŠ¶æ€çš„é›†åˆæ•°é‡</span></span><br><span class="line">		<span class="keyword">else</span> </span><br><span class="line">			res -= n / t; <span class="comment">// åä¹‹åˆ™ä¸º -1</span></span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; res &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          æ‰“èµ
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
          
          æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        åˆ†äº«
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2024/10/07/%E5%A4%8D%E6%9D%82%E6%95%B0%E8%AE%BA/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E8%AE%BA/" rel="tag">æ•°è®º</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/" rel="tag">ç®—æ³•ç«èµ›</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2024/11/07/%E8%83%8C%E5%8C%85DP/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
        <div class="article-nav-title">
          
            èƒŒåŒ…DP
          
        </div>
      </a>
    
    
      <a href="/2024/10/07/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
        <div class="article-nav-title">ä¹˜æ³•é€†å…ƒ</div>
      </a>
    
  </nav>

   
<!-- valineè¯„è®º -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.staticfile.org/valine/1.4.16/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "92B90kPxtBbndNGuCdYouFEO-gzGzoHsz",
    app_key: "GnHcvbn2eo3Vvqi6x4X90ogH",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "ç»™æˆ‘çš„æ–‡ç« åŠ ç‚¹è¯„è®ºå§~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
   
  
   
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2024
        <i class="ri-heart-fill heart_icon"></i> John Doe
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>è®¿é—®äººæ•°:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>æµè§ˆæ¬¡æ•°:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-sea-side.svg" alt="æ¼‚è‡³"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">å‹é“¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/photos">ç›¸å†Œ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">å…³äºæˆ‘</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="æœç´¢">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>è¯·æˆ‘å–æ¯å’–å•¡å§~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js"></script>
<script src="https://cdn.staticfile.org/mathjax/2.7.7/config/TeX-AMS-MML_HTMLorMML-full.js"></script>
<script>
  var ayerConfig = {
    mathjax: true,
  };
</script>

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="86"
        src="//music.163.com/outchain/player?type=2&id=2106426315&auto=1&height=66"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
    

  </div>
<!-- hexo injector body_end start --><script data-pjax src="https://unpkg.com/oh-my-live2d"></script><script>const oml2d = OML2D.loadOml2d({dockedPosition:"left",mobileDisplay:true,models:[{"path":"https://unpkg.com/live2d-widget-model-koharu@1.0.5/assets/koharu.model.json","scale":0.12,"position":[0,0],"stageStyle":{"width":250},"mobileScale":0.08,"mobilePosition":[0,0],"mobileStageStyle":{"width":180}}],parentElement:document.body,primaryColor:"var(--btn-bg)",sayHello:false,tips:{style: {"width":230,"height":120,"left":"calc(50% - 20px)","top":"-100px"},mobileStyle: {"width":180,"height":80,"left":"calc(50% - 30px)","top":"-100px"},idleTips:{interval:15000,message:function(){
  return axios.get('https://v1.hitokoto.cn?c=i')
    .then(function (response) {
      return response.data.hitokoto ;
    })
    .catch(function (error) {
      console.error(error);
    });
}
}}});</script><!-- hexo injector body_end end --></body>

</html>