---
title: å¤æ‚æ•°è®º
date: 2024-10-07 10:50:20
categories: å­¦ä¹ 
tags:
    - ç®—æ³•ç«èµ›
    - æ•°è®º
---

<meta name="referrer" content="no-referrer" />

# å¤æ‚æ•°è®º

<!-- toc -->

<!-- more -->



> æœ€æ²¡æœ‰è‡ªä¿¡çš„ä¸€ç« å“ˆå“ˆğŸ˜…

## 1. è´¨æ•°åˆ¤æ–­

> æ—¶é—´å¤æ‚åº¦ $O(n)â†’O(\sqrt n)$

``` c++
// 1:æœ´ç´ è¯•é™¤
bool isPrime(int n) {
	if(n<2)
		return false;
	for(int i=2;i<=n;i++) {
		if(n%i==0) 
			return false;
	return true;
}
```



``` c++
// 2:æšä¸¾æ¬¡æ•°ä¼˜åŒ–â†’sqrt:è¿™ä¸ªå‡½æ•°æœ¬èº«é€Ÿåº¦è¾ƒæ…¢,ä¸æ¨è
// åŒ…æ‹¬ i*i<=n è¿™ç§å†™æ³•ä¹Ÿä¸æ¨è,å› ä¸ºi*iå¯èƒ½å°äºç­‰äºn,ä½†æ˜¯(i+1)*(i+1)å¯èƒ½ä¼šæº¢å‡ºintå‹æœ€å¤§å€¼,å¦‚æœæº¢å‡ºäº†å°±ä¼šå˜æˆä¸€ä¸ªè´Ÿæ•°,ä»è€Œå½±å“æœ€ç»ˆç­”æ¡ˆçš„åˆ¤æ–­
bool isPrime(int n) {
	if(n<2)
		return false;
	for(int i=2;i<=sqrt(n);i++) {
		if(n%i==0) 
			return false;
	return true;
}
```



``` c++
// 3:æœ€ä½³å†™æ³•åº”è¯¥æ˜¯i<=n/i,é€Ÿåº¦å¿«å¹¶ä¸”ä¸ä¼šæº¢å‡º
bool isPrime(int n) {
	if(n<2)
		return false;
	for(int i=2;i<=n/i;i++) {	
		if(n%i==0) 
			return false;
	return true;
}
```



## 2. åˆ†è§£è´¨å› æ•°

> è´¨å› æ•°çš„åº•æ•°å’ŒæŒ‡æ•°ï¼šåº•æ•°æŒ‡è´¨æ•°çš„åŸºæ•°ï¼Œæ¯”å¦‚åˆ†è§£12=2Ã—2Ã—3æ—¶ï¼Œ2å’Œ3å°±æ˜¯åº•æ•°ï¼Œè€ŒæŒ‡æ•°æŒ‡çš„æ˜¯å„ä¸ªåŸºæ•°å‡ºç°çš„æ¬¡æ•°ï¼Œ2çš„æŒ‡æ•°æ˜¯2ï¼Œ3çš„æŒ‡æ•°æ˜¯1



### 2.1. è¯•é™¤æ³•

> æ—¶é—´å¤æ‚åº¦ $O(n)$

``` c++
void divede(int n) {
	for(int i=2;i<=n;i++) {
		// å…ˆæ‰¾åˆ°è¿™ä¸ªè´¨æ•°
		if(n%i==0) {
			// å†æ±‚è´¨æ•°å‡ºç°çš„æ¬¡æ•°
			int s=0;
			// å½“n%iä¸ç­‰äº0äº†,è¯´æ˜ä¸å†è¢«æ•´é™¤,æŒ‡æ•°æ±‚å®Œäº†
			while(n%i==0) {
				n/=i;
				s++;
			}
			cout<<i<<' '<<s<<endl;
		}
	}
}
```



### 2.2. æšä¸¾æ¬¡æ•°ä¼˜åŒ–

* å¯¹ä¸Šè¿°ç®—æ³•è¿›è¡Œä¼˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜nä¸­æœ€å¤šåŒ…å«ä¸€ä¸ªå¤§äºsqrt(n)çš„è´¨å› å­ï¼ˆå‡è®¾æœ‰ä¸¤ä¸ªçš„è¯ï¼Œä¸¤ä¸ªå¤§äºsqrt(n)çš„è´¨å› å­ç›¸ä¹˜çš„ç»“æœå°±å¤§äºnäº†ï¼Œæ‰€ä»¥ä¸æˆç«‹ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥å’Œä¼˜åŒ–æ±‚è´¨æ•°æ—¶ä¸€æ ·çš„åšæ³•æ¥å‡å°‘æšä¸¾æ¬¡æ•°ã€‚

> æ—¶é—´å¤æ‚åº¦ $[O(log(n)),\ O(sqrt(n))]$

``` c++
void divede(int n) {
	for(int i=2;i<=n/i;i++) {
		if(n%i==0) {
			int s=0;
			while(n%i==0) {
				n/=i;
				s++;
			}
			cout<<i<<' '<<s<<endl;
		}
	}
	// å› ä¸ºæˆ‘ä»¬è¯æ˜äº†å¤§äºsqrt(n)çš„æ•°æœ€å¤šåªæœ‰ä¸€ä¸ª
	// é‚£ä¹ˆnå¦‚æœè¿˜>1,è¯´æ˜æ²¡é™¤å®Œ,é‚£å‰©ä¸‹çš„é‚£ä¸ªå¿…å®šå°±æ˜¯å¤§äºsqrt(n)çš„è´¨å› å­
	if(n>1)
		cout<<n<<' '<<1<<endl;
}
```



## 3. è´¨æ•°ç­›

### 3.1. æœ´ç´ æ³•

> æ—¶é—´å¤æ‚åº¦çº¦ç­‰äº $O(nln^n)<O(nlog^n)$

``` c++
const int N=1e6+10; // ç­›é€‰1~1e6+10ä¸­çš„è´¨æ•°
// primes:è®°å½•è´¨æ•°å°äºç­‰äºNçš„æ‰€æœ‰è´¨æ•°,cnt:è®°å½•è´¨æ•°ä¸ªæ•°
// primesä¸­ä¸‹æ ‡ä¸º0~cnt-1å­˜å‚¨çš„å°±æ˜¯æ‰€æœ‰å°äºç­‰äºNçš„è´¨æ•°
int primes[N],cnt; 
bool st[N]; // è®°å½•æ¯ä¸ªæ•°çš„è®¿é—®çŠ¶æ€,ä¸ºtrueçš„è¯´æ˜ä¸æ˜¯è´¨æ•°

void get_primes(int n) {
	// ä»2å¼€å§‹éå†æ•°å­—,å¹¶æŠŠå…¶å¯¹åº”å€æ•°çš„æ•°å­—å…¨éƒ¨è®¾ç½®æˆå·²è®¿é—®
	for(int i=2;i<=n;i++) {
		// å¦‚æœæ²¡æœ‰è®¿é—®è¿‡
		if(!st[i]) {
			primes[cnt++]=i;
		}
		// ä»i*2å¼€å§‹,åªè¦æ˜¯içš„å€æ•°éƒ½è®¾ç½®æˆå·²è®¿é—®
		for(int j=i+i;j<=n;j+=i)
			st[j]=true;
	}
}
```



### 3.2. åŸƒåŠç­›

> æšä¸¾ä¼˜åŒ–ï¼Œæ—¶é—´å¤æ‚åº¦ $O(nlg^{lg^n})$ï¼Œçº¦ç­‰äº $O(n)$

* è´¨æ•°å®šç†ï¼š1~nå½“ä¸­æœ‰ $n/ln(n)$ ä¸ªè´¨æ•°ï¼Œæˆ‘ä»¬åœ¨éå†çš„æ—¶å€™åªæŠŠè´¨æ•°é€‰å‡ºæ¥

``` c++
void get_primes(int n) {
	for(int i=2;i<=n;i++) {
		if(!st[i]) {
			// å†é€‰å‡ºåŸºç¡€æ•°çš„åŸºç¡€ä¸Šç›´æ¥åœ¨æ­¤éå†ç­›è´¨æ•°
			primes[cnt++]=i;
			for(int j=i+i;j<=n;j+=i)
				st[j]=true;
		}
	}
}
```



### 3.3. æ¬§æ‹‰ç­›

> æ—¶é—´å¤æ‚åº¦ $O(n)$ï¼ŒçœŸæ­£æ„ä¹‰ä¸Šçš„çº¿æ€§ç­›

* çº¿æ€§ç­›æ³•å°±åœ¨æ¬§æ‹‰ç­›çš„åŸºç¡€ä¸Šæ”¹è¿›äº†ä¸€ä¸ªä¸œè¥¿ï¼Œ$n$ åªä¼šè¢«æœ€å°è´¨å› å­ç­›æ‰ï¼Œæ¬§æ‹‰ç­›ã€åŸƒåŠç­›éƒ½æ˜¯å»ºç«‹åœ¨2æ˜¯å…¬è®¤çš„æœ€å°çš„è´¨æ•°ä¸Šåšçš„ï¼Œå»ºè®®ç–¯ç‹‚çœ‹æ³¨é‡Šç†è§£å—·

``` c++
const int N=1e6+10;
bool st[N];
int primes[N],cnt;

void get_primes(int n) {
	for(int i=2;i<=n;i++) {
		if(!st[i])
			primes[cnt++]=i;
		// primes[j](è´¨æ•°)*i<=n,éå†primes[j]å³ä¸º:primesæ•°ç»„ä¸­å½“å‰çš„æ‰€æœ‰è´¨æ•°
		for(int j=0;primes[j]<=n/i;j++) {
			// primes[j]ä¸€å®šæ˜¯içš„æœ€å°è´¨å› å­,primes[j]ä¸€å®šä¹Ÿæ˜¯primes[j]*içš„æœ€å°è´¨å› å­
			st[primes[j]*i]=true;
			// å¯¹äºä¸€ä¸ªåˆæ•°x,å‡è®¾primes[j]æ˜¯xçš„æœ€å°è´¨å› å­,å½“iæšä¸¾åˆ°x/primes[j]æ—¶å°±break
			// å•¥å­æ„æ€,å°±æ˜¯è¯´æˆ‘iæ˜¯ä¸ªåˆæ•°çš„è¯å°±åªç­›ä¸€é,è¿™æ ·æ‰èƒ½è¾¾åˆ°è¿‘ä¼¼O(n)çš„æ•ˆæœ
			// æ¯”å¦‚i=6æ—¶,è´¨æ•°é›†ä¸­æœ‰2,3,5è¿™ä¸‰ä¸ªæ•°,é‚£ä¹ˆæˆ‘åªç­›2*6=12,3*6å’Œ5*6ä¸ç­›
			// ä¸ºä»€ä¹ˆä¸ç­›?å› ä¸ºæˆ‘åœ¨ç®—3*6=18æ—¶,i=9,9*2ä¹Ÿä¸º18,å…¶å®ä¹Ÿç­›æ‰äº†
			// æ‰€ä»¥å¯¹äºåˆæ•°,æˆ‘ä»¬åªç”¨å…¶æœ€å°è´¨å› å­æ¥ç­›,æå‰breakå°±å¯ä»¥é¿å…é‡å¤ç­›
			if(i%primes[j]==0)
				break;
		}
	}
}
```



## 4. çº¦æ•°

### 4.1. è¯•é™¤æ³•æ±‚çº¦æ•°ä¸ªæ•°

``` c++
// æ±‚å–çº¦æ•°çš„å‡½æ•°
vector<int> get_divisors(int n) {
	vector<int> res;
	// æšä¸¾ä¼˜åŒ–
	for(int i=1;i<=n/i;i++) {
		if(n%i==0) {
			res.push_back(i);
			// å¦‚æœiå’Œn/iæ˜¯åŒä¸€ä¸ªæ•°å­—,é‚£ä¹ˆåªç”¨æ”¾ä¸€é
			if(i!=n/i)
				res.push_back(n/i);
		}
	}
	sort(res.begin(),res.end()); // ä»å°åˆ°å¤§æ’åº
	return res;
}
```



### 4.2. å…¬å¼æ±‚çº¦æ•°ä¸ªæ•°

* åŸºäºç®—æœ¯åŸºæœ¬å®šç†ï¼Œ$N$ çš„çº¦æ•°çš„ä¸ªæ•°å°±å’Œ $[Î²_1,Î²_k]$ çš„å–æ³•æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼›æ‰€ä»¥ $[Î²_1,Î²_k]$ å°±æ˜¯ $Î±_1$ çš„é€‰æ³•ï¼Œå…± $(Î±_1+1)$ ç§ï¼Œä¹Ÿè¡¨ç¤º $Î±2$ çš„é€‰æ³•ï¼Œå…± $(Î±_2+1)$ ç§ï¼Œæ ¹æ®ä¹˜æ³•å®šç†ï¼Œæ‰€ä»¥ï¼šå¯¹äºä¸€ä¸ªæ•° $N$ï¼Œçº¦æ•°ä¸ªæ•°ä¸€å®šæ˜¯ $(Î±_1+1)Ã—(Î±_2+1)Ã—(Î±_3+1)Ã—Â·Â·Â·(Î±_k+1)$
* åªè¦æˆ‘ä»¬èƒ½æ±‚è§£å‡ºä¸€ä¸ªæ•°åˆ†è§£è´¨å› æ•°çš„ç»“æœï¼Œå°±èƒ½æ±‚å‡ºå…¶çº¦æ•°ä¸ªæ•°

![image-20231201152205955](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231201152205955.png)

* PSï¼šintèŒƒå›´å†…ï¼Œçº¦æ•°ä¸ªæ•°æœ€å¤šçš„æ•°çš„çº¦æ•°ä¸ªæ•°å¤§æ¦‚æ˜¯1500å·¦å³ã€‚

``` c++
#include<bits/stdc++.h>
#define x first
#define y second
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int,int> PII;

// æŠŠå› å¼åˆ†è§£æ¯ä¸ªåŸºæ•°çš„åº•æ•°å’ŒæŒ‡æ•°å­˜åˆ°ä¸€ä¸ªmapä¸­
const int mod=1e9+7;

int main() {
	// æ±‚nä¸ªæ•°ä¹˜ç§¯çš„çº¦æ•°çš„ä¸ªæ•°,å¹¶å¯¹modå–ä½™
	int n;
	cin>>n;
	unordered_map<int,int> primes;
	while(n--) {
		int x;
		cin>>x;
		for(int i=2;i<=x/i;i++) {
			while(x%i==0) {
				x/=i;
				// å¯¹è¿™nä¸ªæ•°çš„çº¦æ•°éƒ½ç”¨primesæ¥å­˜,æœ€åç»Ÿä¸€ç®—å‡ºçº¦æ•°ä¸ªæ•°
				primes[i]++; 
			}
		}
		// å¦‚æœxè¿˜å¤§äº1,æŠŠå‰©ä¸‹å¤§çš„é‚£ä¸ªè´¨å› æ•°ç»™åŠ ä¸Š
		if(x>1)
			primes[x]++;
	}
	
	// primesä¸­å­˜å‚¨äº†æ‰€æœ‰çš„åº•æ•°å’Œå…¶å¯¹åº”çš„æŒ‡æ•°
	ll res=1;
	for(auto prime:primes)
		res=res*(prime.second+1)%mod;
	cout<<res<<endl;
	return 0;
}
```



### 4.3. çº¦æ•°ä¹‹å’Œ

* åªè¦æˆ‘ä»¬èƒ½æ±‚è§£å‡ºä¸€ä¸ªæ•°åˆ†è§£è´¨å› æ•°çš„ç»“æœï¼Œå°±èƒ½æ±‚å¾—å…¶çº¦æ•°ä¹‹å’Œï¼ŒæŠŠnçš„æ‰€æœ‰çº¦æ•°å±•å¼€ï¼Œå…¬å¼å°±æ˜¯ä¸‹å›¾ï¼š

![](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231201152853841.png)

``` c++
#include<bits/stdc++.h>
#define x first
#define y second
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int,int> PII;

// æŠŠå› å¼åˆ†è§£æ¯ä¸ªåŸºæ•°çš„åº•æ•°å’ŒæŒ‡æ•°å­˜åˆ°ä¸€ä¸ªmapä¸­
const int mod=1e9+7;

int main() {
	// æ±‚nä¸ªæ•°ä¹˜ç§¯çš„çº¦æ•°çš„ä¸ªæ•°,å¹¶å¯¹modå–ä½™
	int n;
	cin>>n;
	unordered_map<int,int> primes;
	while(n--) {
		int x;
		cin>>x;
		for(int i=2;i<=x/i;i++) {
			while(x%i==0) {
				x/=i;
				// å¯¹è¿™nä¸ªæ•°çš„çº¦æ•°éƒ½ç”¨primesæ¥å­˜,æœ€åç»Ÿä¸€ç®—å‡ºçº¦æ•°ä¸ªæ•°
				primes[i]++; 
			}
		}
		// å¦‚æœxè¿˜å¤§äº1,æŠŠå‰©ä¸‹å¤§çš„é‚£ä¸ªè´¨å› æ•°ç»™åŠ ä¸Š
		if(x>1)
			primes[x]++;
	}
	
	// primesä¸­å­˜å‚¨äº†æ‰€æœ‰çš„åº•æ•°å’Œå…¶å¯¹åº”çš„æŒ‡æ•°
	ll res=1;
	for(auto prime:primes) {
		int p=prime.first; // åº•æ•°
		int a=prime.second; // æŒ‡æ•°
		ll t=1;
        // æ¯ä¸€æ¬¡æä¸€ä¸ªpå‡ºæ¥
        // 1+p1(p1^0+p1^1+Â·Â·Â·+p1^(Î±1-1))
		while(a--)
			t=(t*p+1)%mod;
		res=res*t%mod; // ç»“æœåŒæ ·å¯¹modå–ä½™
	}
	cout<<res;
	return 0;
}
```



## 4. æœ€å¤§å…¬çº¦æ•°

* æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œä¹Ÿå«è¾—è½¬ç›¸é™¤æ³•
* å¦‚æœaèƒ½é™¤dï¼Œbèƒ½é™¤dï¼Œé‚£ä¹ˆ(a+b)ä¹Ÿèƒ½æ•´é™¤dï¼Œæ¯”å¦‚6èƒ½è¢«2æ•´é™¤ï¼Œ14èƒ½è¢«2æ•´é™¤ï¼Œé‚£ä¹ˆ20èƒ½è¢«2æ•´é™¤ï¼Œç”šè€…è¿˜æœ‰ aÂ·x+bÂ·y èƒ½è¢«dæ•´é™¤
* æ ¹æ®è¾—è½¬ç›¸é™¤æ³•ï¼Œaå’Œbçš„æœ€å¤§å…¬çº¦æ•°å°±ç­‰äºbå’Œa mod bçš„æœ€å¤§å…¬çº¦æ•°ã€‚æ€ä¹ˆæ¨çš„ï¼Ÿ

* $a\%b=a-floor(a/b)Ã—b$ ï¼Œå†™æˆ $a-cÃ—b$ï¼Œé‚£ä¹ˆ $(a,b)=(b, a - c Ã— b)$
* å¯¹äºå·¦ä¾§ï¼Œ$(a,b)$ï¼Œå‡è®¾ $d$ èƒ½æ•´é™¤ $a$ ï¼Œ$d$ ä¹Ÿèƒ½æ•´é™¤ $b$ï¼Œå¯¹äºå³ä¾§ï¼Œ$d$ èƒ½æ•´é™¤ $b$ï¼Œç°åœ¨åªéœ€è¦è¯æ˜ $d$ ä¹Ÿèƒ½æ•´é™¤ $a$ ï¼Œå°±èƒ½è¯´æ˜å·¦å³ä¸¤ä¾§ç­‰ä»·äº†ï¼Œ$d$ èƒ½æ•´é™¤ $a - c Ã— b$ï¼Œåªéœ€è¦åœ¨å³ä¾§åŠ ä¸Šä¸€ä¸ª $c Ã— b$ (ç›¸å½“äº $aÃ—x+bÃ—y$ )ï¼Œå°±èƒ½è¯´æ˜ $d$ èƒ½æ•´é™¤ $a$ äº†ï¼Œæ‰€ä»¥å·¦å³ä¸¤ä¾§ç­‰ä»·ã€‚è¯æ¯•ï¼Œ$(a,b)=(b,a\%b)$

```c++
int gcd(int a,int b) {
    // å½“b=0æ—¶,(a,0)çš„æœ€å¤§å…¬çº¦æ•°ä¸€å®šæ˜¯a,æ‰€ä»¥è¿”å›å€¼çš„ç¬¬äºŒé¡¹æ˜¯a
	return b?gcd(b,a%b):a;
}
```



## 5. æ¬§æ‹‰å‡½æ•°

> æ—¶é—´å¤æ‚åº¦$O(sqrt(n))$ï¼Œæ¥æºäºåˆ†è§£è´¨å› æ•°çš„$O(sqrt(n))$

### 5.1. å®šä¹‰æ³•

* $Ï†(n)$è¡¨ç¤º1~nä¸­ä¸näº’è´¨çš„ä¸ªæ•°ï¼Œæ¯”å¦‚$Ï†(6)$ï¼Œ$[1,6]$ ä¸­æœ‰1,5ä¸6äº’è´¨ï¼ˆäº’è´¨ï¼šå…¬çº¦æ•°åªæœ‰1çš„ä¸¤ä¸ªæ•´æ•°ï¼Œå«åšäº’è´¨æ•´æ•°ï¼‰ï¼Œæ‰€ä»¥$Ï†(6)$=2

![image-20231201162530871](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231201162530871.png)

* æ ¹æ®å®¹æ–¥åŸç†å¯ä»¥æ¨å¯¼ï¼Œå®¹æ–¥åŸç†ï¼š

1. ä» $[1,N]$ ä¸­å»æ‰ $p_1, p_2, ... , p_k$ çš„æ‰€æœ‰å€æ•°ï¼Œè€Œ $[1,N]$ å½“ä¸­ $p_k$ çš„å€æ•°ç­‰äº$N-N/p_1-N/p_2-Â·Â·Â·-N/p_k$ï¼Œæ­¤æ—¶æœ‰äº›æ•°å¯èƒ½æ—¢æ˜¯$p_1$çš„å€æ•°ï¼Œä¹Ÿæ˜¯$p_2$çš„å€æ•°ï¼Œå°±å¤šå»é™¤äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥æ­¤æ—¶è¿›è¡Œç¬¬äºŒæ­¥ï¼›

2. åŠ ä¸Šæ‰€æœ‰$p_iÃ—p_j$çš„å€æ•°ï¼Œiå’Œjæ˜¯1~Kä¸­ä»»æ„ä¸¤ä¸ªæ•°ï¼Œå¾—åˆ°ä¸‹å¼ï¼š

   $N-N/p_1-N/p_2-Â·Â·Â·-N/p_k+N/p_1Ã—p_2+N/p_1Ã—p_3+Â·Â·Â·N/p_{k-1})Ã—p_k$

3. è¿™æ—¶å€™åˆä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªæ•°æ—¢æ˜¯$p_1$ã€$p_2$ï¼Œä¹Ÿæ˜¯$p_3$çš„å€å‘¢ï¼Ÿå®ƒå°±ä¼šè¢«p1å‡ä¸€æ¬¡ï¼Œp2å‡ä¸€æ¬¡ï¼Œp3å†å‡ä¸€æ¬¡ï¼Œå†åœ¨ç¬¬äºŒæ­¥ä¸­åŠ ä¸Šä¸‰æ¬¡ï¼Œæ‰€ä»¥ç¬¬ä¸‰æ­¥ï¼›è¿™ä¸ªæ—¶å€™ç›¸å½“äºåŠ å›æ¥äº†ï¼Œè€Œæˆ‘ä»¬æ˜¯æƒ³æŠŠå®ƒåˆ å»ï¼Œæ‰€ä»¥è¿˜è¦å‡å»æ‰€æœ‰piÃ—pjÃ—pkçš„å€æ•°ï¼Œå¾—åˆ°ä¸‹å¼ï¼š$N-N/p1-N/p2-Â·Â·Â·-N/pk+N/p1Ã—p2+N/p1Ã—p3+Â·Â·Â·N/p(k-1)Ã—pk-N/p1Ã—p2Ã—p3-N/p1Ã—p2Ã—p4-Â·Â·Â·-N/p(k-2)Ã—p(k-1)Ã—pk$ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€åå¾—åˆ°çš„å…¬å¼å…¶å®å°±æ˜¯ä¸‹é¢è¿™ä¸ªå‡½æ•°çš„å±•å¼€ï¼Œæ‰€ä»¥æ¬§æ‹‰å‡½æ•°å…¶å®å°±æ˜¯å®¹æ–¥åŸç†çš„å±•å¼€ï¼š

![image-20231201163755176](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231201163755176.png)

``` c++
void get_ola(int n)
{
	int res=n;
   	// æ‰¾nçš„æ‰€æœ‰è´¨å› å­
	for(int i=2;i<=n/i;i ++) {
		if(n%i==0) {
			// res=res*(1-1/a):è¿™æ˜¯æ¬§æ‹‰å…¬å¼
			// åƒä¸‹é¢è¿™ä¸ªå…¬å¼ä¸€æ ·è½¬æ¢æ˜¯ä¸ºäº†é¿å…å‡ºç°å°æ•°,å› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ•´æ•°è¿ç®—,ä¿è¯åªæœ‰æ•´æ•°
			res=res/i*(i-1);
			while(n%i==0)
				n/=i;
		} 
	}
	if(n>1)
		res=res/n*(n-1);
	cout<<res<<endl;
}
```



### 5.2. ç­›æ³•

* åœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦æ±‚å‡º $[1,N]$ ä¸­æ¯ä¸€ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°ï¼Œè¿™ç§æƒ…å†µä¸‹ç”¨å…¬å¼å°±éå¸¸çš„æ…¢ï¼Œå¯ä»¥å€ŸåŠ©ä¹‹å‰çº¿æ€§ç­›çš„æ€æƒ³ï¼Œç”¨ $O(n)$ çš„æ—¶é—´å¤æ‚åº¦æ±‚å‡ºæ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°ã€‚

``` c++
#include<bits/stdc++.h>
#define x first
#define y second
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int,int> PII;

const int N=1e6+10;
int primes[N];
bool st[N];
int cnt;
int phi[N]; // phi[i]:1~iä¸­æœ‰å¤šä¸ªæ•°å’Œiäº’æ–¥
ll res;

// åœ¨çº¿æ€§ç­›çš„è¿‡ç¨‹ä¸­æ±‚æ¬§æ‹‰å‡½æ•°
ll get_eulers(int n) {
	phi[1]=1; // 1~1ä¸­å’Œ1äº’æ–¥çš„åªæœ‰è‡ªå·±
	for(int i=2;i<=n;i++) {
		if(!st[i]) {
			primes[cnt++]=i;
			// å¦‚æœiæ˜¯è´¨æ•°,é‚£ä¹ˆå‰i-1ä¸ªæ•°éƒ½å’Œiäº’è´¨
			phi[i]=i-1;
		}
		for(int j=0;primes[j]<=n/i;j++) {
			st[primes[j]*i]=true;
			if(i%primes[j]==0) {
				// i mod pj==0æ—¶è¯´æ˜pjæ˜¯içš„è´¨å› å­
				// phi(pj*i)å°±ç­‰äºpj*phi(i)
				phi[primes[j]*i]=primes[j]*phi[i];
				break;
			}
			// i mod pj!=0, pj ä¸€å®šæ˜¯ i*pj çš„è´¨å› å­
			// phi(pj*i)å°±ç­‰äºp(j-1)*phi(i)
			phi[primes[j]*i]=phi[i]*(primes[j]-1);
		}
	}
	ll res=0;
	for(int i=1;i<=n;i++)
		res+=phi[i];
	return res;
}

int main() {
	// æ±‚1~nä¸­æ¯ä¸ªæ•°çš„æ¬§æ‹‰å‡½æ•°ä¹‹å’Œ
	int n;
	cin>>n;
	cout<<get_eulers(n)<<endl;
	return 0;
}
```



### 5.3. æ¬§æ‹‰å®šç†

* å¦‚æœ $a$ ä¸ $n$ äº’è´¨ï¼Œé‚£ä¹ˆ $a^phi(n)\ mod\ n$ åŒä½™ $1$ï¼Œä¾‹å¦‚ï¼š$a=5$, $n=6$ æ—¶æœ‰ï¼š$5^phi(6) = 5^2 =25ï¼Œ25 mod 6 =1

â€‹		æ¬§æ‹‰å®šç†æ¨è®ºï¼šè‹¥ a^phi(p) mod p =1ï¼Œå‡è®¾pæ˜¯è´¨æ•°ï¼Œåˆ™æœ‰ a^(p-1) mod p=1ï¼Œè¿™ä¹Ÿæ˜¯è´¹é©¬(å°)å®šç†ã€‚å¦‚æœn=5ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æŠŠ1å’Œ6è§†ä¸ºåŒæ ·çš„å€¼ï¼Œå› ä¸º1%5 == 6%5 == 1ã€‚



## 6. å¿«é€Ÿå¹‚

> èƒ½åœ¨ $O(log^k)$ çš„æ—¶é—´ä¸‹å¿«é€Ÿæ±‚å‡º $a^k\ mod\ p$ çš„ç»“æœï¼Œå…¶ä¸­ $a,\ p,\ k<=10^9$

* å¯¹äº $a^k\ mod\ p$ï¼Œå¿«é€Ÿå¹‚å°±æ˜¯é¢„è®¡ç®—å‡º $a^{(2^0)}\ mod\ p$ çš„ç»“æœã€ $a^{(2^1)}\ mod\ p$ çš„ç»“æœã€... ã€ $a^{2^{(log^k)}}\ mod\ p$ çš„ç»“æœï¼Œä¸€å…± $log^k$ ä¸ªæ•°ï¼Œå¦‚æœè¦æŠŠ $a^k$ ç»„åˆå‡ºæ¥ï¼Œå…¶å®å°±æ˜¯ä¸€ç§äºŒè¿›åˆ¶ä¼˜åŒ–
* æ¯”å¦‚æˆ‘ä»¬è¦è®¡ç®— $4^5\ mod\ 10$ ï¼Œå°±é¢„ç®—å‡º $4^{2^0}\ mod\ 10$ã€ $4^{2^1}\ mod\ 10$ã€ $4^{2^2}\ mod\ 10$ çš„ç»“æœï¼Œ$5$ çš„äºŒè¿›åˆ¶åˆç­‰äº $(101)_2$ï¼Œæ‰€ä»¥å°±æ˜¯ $4^ {2^0} mod 10 Ã— 4^{2^2}\ mod\ 10$



### 6.1. å¿«é€Ÿå¹‚

``` c++
int qmi(int a,int k,int p) {
	int res=1;
	while(k) {
		// å–2è¿›åˆ¶æœ€åä¸€ä½,å¦‚æœä¸º1,åˆ™ä¹˜ä»¥è¿™ä¸€ä½çš„ä½æƒ
		if(k&1)
			res=(ll)res*a%p;
		// å»æ‰æœ€åä¸€ä½
		k>>=1;
		a=(ll)a*a%p; // ä½æƒæå‡
	}
	return res;
}
```



### 6.2. å¿«é€Ÿå¹‚æ±‚é€†å…ƒ

> $a/b = aÃ—x\ (mod\ m)$ï¼Œæ‰¾åˆ°è¿™ä¸ª $x$ ï¼Œå°±å¯ä»¥æŠŠé™¤æ³•å˜ä¸ºä¹˜æ³•ï¼Œç­‰å¼ä¸¤ç«¯çº¦å» $a$ï¼Œå¾—åˆ° $bÃ—x=1(mod\ m)$ï¼Œå³åªè¦æ‰¾åˆ°æ•°å­— $x$ ï¼Œä½¿å¾— $bÃ—x\ mod\ m$ çš„å€¼ç­‰äº $1$ï¼Œ$x$ å°±æ˜¯é€†å…ƒã€‚

![image-20231205080313203](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231205080313203.png)

* å¦‚æœ $p$ æ˜¯è´¨æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼å­ä¼šå˜æˆä¸€ä¸ªè´¹é©¬å®šç†ï¼Œæ‰€ä»¥ $b^{p-1}=1(mod p)$ï¼ŒæŠŠ $b^(p-1)$ å†™æˆ $bÃ—b^(p-2)$ ï¼Œ é‚£ä¹ˆ $b^(p-2)$ å°±æ˜¯ $b\ mod\ p$ çš„é€†å…ƒï¼Œåˆå› ä¸ºæœ€å°çš„è´¨æ•°æ˜¯ $2$ ï¼Œæ‰€ä»¥ $p-2$ ä¸€å®šæ˜¯ $â‰¥0$ çš„ï¼Œæ‰€ä»¥æˆç«‹ã€‚æ‰€ä»¥é¢˜ç›®å˜æˆä¸€ä¸ªå¿«é€Ÿå¹‚ï¼Œæ±‚å– $b^{p-2}\ mod\ p$
* æ³¨æ„ï¼šå¦‚æœ $p$ å’Œ $b$ ä¹‹é—´å­˜åœ¨å€æ•°å…³ç³»ï¼ˆä¸äº’è´¨ï¼‰çš„è¯ï¼Œé‚£ä¹ˆ $bÃ—x\ mod\ p$ ä¸€å®šç­‰äº $0$ ï¼Œæ­¤æ—¶é€†å…ƒæ— è§£ï¼›å½“æ²¡æœ‰å€æ•°å…³ç³»æ—¶ï¼Œä¸€å®šæ˜¯æœ‰è§£çš„ã€‚**åªæœ‰å½“ä¿è¯ $p$ æ˜¯è´¨æ•°æ—¶ï¼Œæ‰èƒ½ä½¿ç”¨å¿«é€Ÿå¹‚æ±‚é€†å…ƒï¼**

``` c++
#include<bits/stdc++.h>
#define x first
#define y second
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int,int> PII;

int qmi(int a,int k,int p) {
	int res=1;
	while(k) {
		// å–2è¿›åˆ¶æœ€åä¸€ä½,å¦‚æœä¸º1,åˆ™ä¹˜ä»¥è¿™ä¸€ä½çš„ä½æƒ
		if(k&1)
			res=(ll)res*a%p;
		// å»æ‰æœ€åä¸€ä½
		k>>=1;
		a=(ll)a*a%p; // ä½æƒæå‡
	}
	return res;
}

int main() {
	int n;
	cin>>n;
	while(n--) {
		int a,p;
		cin>>a>>p;
		int res=qmi(a,p-2,p);
		// å¦‚æœaæ˜¯pçš„å€æ•°,åˆ™æ²¡æœ‰é€†å…ƒ,å› ä¸º a*x mod pä¸€å®šç­‰äº0
		if(a%p)
			cout<<res<<endl;
		else
			cout<<"impossible"<<endl;
	}
	return 0;
}
```



## 7. æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

### 7.1. è£´èœ€å®šç†

* å¯¹äºä»»æ„ä¸€å¯¹æ­£æ•´æ•° $a,b$ ï¼Œé‚£ä¹ˆä¸€å®šå­˜åœ¨éé›¶æ•´æ•° $x,y$ ï¼Œä½¿å¾— $aÃ—x+bÃ—y=gcd(a,b)$ ï¼Œå¹¶ä¸” $a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°æ˜¯ $a$ å’Œ $b$ å‡‘å‡ºæ¥çš„æœ€å°çš„æ­£æ•´æ•°
* å¦‚ä½•è¯æ˜ï¼Ÿ$gcd(a,b)$ æ˜¯ $a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°ï¼Œé‚£ä¹ˆ $a$ å’Œ $b$ çš„çº¿æ€§ç»„åˆä¸€å®šæ˜¯æœ€å¤§å…¬çº¦æ•°çš„å€æ•°ï¼Œé‚£ä¹ˆæœ€å°çš„å€æ•°å°±æ˜¯ $1$ å€å‘—ï¼Œæ‰€ä»¥ä¸€å®šèƒ½å‡‘å‡ºï¼š$aÃ—x+bÃ—y=gcd(a,b)$



### 7.2. æ‰©å±•æ¬§å‡ é‡Œå¾—

``` c++
#include<bits/stdc++.h>
#define x first
#define y second
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int,int> PII;

// æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•
int exgcd(int a,int b,int &x,int &y) {
	// å¦‚æœb=0,é‚£ä¹ˆgcd(a,b)==a,çº¿æ€§ç»„åˆå³æ˜¯(1,0)
	if(!b) {
		x=1,y=0;
		return a;
	}

	int d=exgcd(b,a%b,y,x);
	// â‘ b*y+(a mod b)*x=gcd(a,b)
	// â‘¡åˆ a mod b=a-floor(a/b)*bâ†’è¯æ˜:å‡è®¾ræ˜¯a mod bçš„ä½™æ•°,ç°åœ¨æˆ‘ä»¬è¦æ±‚è¿™ä¸ªr,a/b=floor(a/b)+r,âˆ´r=a-floor(a/b)*b	
	// äºŒå¼ç›¸ç»“åˆ,æœ‰: a*x+b*(y-floor(a/b)*x)=gcd(a,b),å³xçš„ç³»æ•°ä¸å˜,ä½†æ˜¯yè¦å‡å»é‚£ä¸€å¨
	y-=a/b*x;
	return d;
}

int main() {
	int n;
	cin>>n;
	while(n--) {
		int a,b,x,y;
		cin>>a>>b;
		exgcd(a,b,x,y);
		cout<<x<<' '<<y<<endl; // æ³¨æ„:xå’Œyä¸å”¯ä¸€
	}
	return 0;
}
```



### 7.3. ã€åº”ç”¨ã€‘çº¿æ€§åŒä½™æ–¹ç¨‹

> ç»™å®š $a,b,m$ï¼Œæ±‚æ•´æ•° $x$ ä½¿å¾—  $aÃ—x\ mod\ m=b$ï¼ˆå¦‚æœ $b$ ä¸º $1$ å°±æ˜¯æ±‚é€†å…ƒäº†æ˜¯å§ï¼Œå¦‚æœ $m$ å†ä¸ºè´¨æ•°ï¼Œå°±å¯ä»¥ç”¨å¿«é€Ÿå¹‚äº†ï¼‰ï¼Œæ³¨æ„ $x$ çš„è§£ä¸å”¯ä¸€ã€‚

$$
ax\equiv b(mod\ m) \ ç­‰ä»·äºå­˜åœ¨æ•´æ•°yâˆˆZ,\ st. \ ax=m*y+b \ ,å³mçš„è‹¥å¹²å€å†åŠ ä¸Šb
\\
åŒ–ç®€å¾—\ ax-my=b, \ æŠŠ-yä»¤æˆy'ï¼Œå³æœ‰\ ax+my'=b, \ å°±å˜æˆäº†æ‰©å±•æ¬§å‡ é‡Œå¾—çš„æ–¹ç¨‹
\\ 
æ‰€ä»¥æ ¹æ®æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•å¯ä»¥æ±‚å‡ºä¸€ç»„ç³»æ•°x,y'ä½¿å¾—ax+my'=b, \ dæ˜¯æœ€å¤§å…¬çº¦æ•°
$$

``` c++
#include<bits/stdc++.h>
#define x first
#define y second
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int,int> PII;

int exgcd(int a,int b,int &x,int &y) {
	if(!b) {
		x=1,y=0;
		return a;
	}
	int d=exgcd(b,a%b,y,x);
	y-=a/b*x;
	return d;
}

int main() {
	int n;
	cin>>n;
	while(n--) {
		// a*x mod m =b
		int a,b,m;
		cin>>a>>b>>m;
		int x,y;
		int d=exgcd(a,m,x,y);
		// å¦‚æœbä¸æ˜¯dçš„å€æ•°æ–¹ç¨‹æ— è§£,å› ä¸ºa*xæ— æ³•é€šè¿‡%måŒä½™ç­‰äºb
		if(b%d)
			cout<<"impossible"<<endl;
		else
			// æ³¨æ„è¿™ä¸ªè§£ä¸å”¯ä¸€
			// å½“bæ˜¯dçš„å€æ•°æ—¶,æ–¹ç¨‹ä¸¤è¾¹åŒæ—¶åˆä¸€d,å¾—åˆ° a/d*x=b/d(mod m/d),ç”±äº
			// a/då’Œm/dæ˜¯äº’è´¨çš„,å¯ä»¥æ‰¾åˆ°a/dçš„é€†å…ƒx',ä½¿å¾—(a/b)*x'=1(mod m/d)
			// æ‰€ä»¥è®© b/dä¹˜ä»¥è¿™ä¸ªç±³è¿œx'å¾—åˆ°x*(b/d),è¿™å°±æ˜¯xçš„ä¸€ä¸ªç‰¹è§£
			cout<<(ll)x*(b/d)%m<<endl;
	}
	return 0;
}
```



### 7.4. ã€åº”ç”¨ã€‘ä¸­å›½å‰©ä½™å®šç†

![image-20231205095348192](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231205095348192.png)

* æ³¨æ„ï¼š$m_1,\ Â·Â·Â·\ ,m_n$ ä¹‹é—´æ˜¯ä¸¤ä¸¤äº’è´¨çš„

``` c++
#include <iostream>
#include <algorithm>

using namespace std;

typedef long long LL;

LL exgcd(LL a,LL b,LL &x,LL &y){
	if(!b){
		x=1,y=0;
		return a;
	}
	
	LL d=exgcd(b,a%b,y,x);
	y-=a/b*x;
	return d;
}

int main()
{
	int n;
	cin>>n;
	LL x=0,m1,a1;
	cin>>a1>>m1;
	for(int i=0;i<n-1;i++){
		LL m2,a2;
		cin>>a2>>m2;
		LL k1,k2;
		LL d=exgcd(a1,a2,k1,k2);
		if((m2-m1)%d){
			x=-1;
			break;
		}
		
		//æ›´æ–°çŠ¶æ€
		k1*=(m2-m1)/d;
		LL t=a2/d;
		// å°†è§£å˜æˆä¸€ä¸ªæœ€å°çš„æ­£æ•´æ•°è§£
		k1=(k1%t+t)%t;
		
		x=k1*a1+m1;
		// æ›´æ–°aå’Œm,kåªæ˜¯ä¸ªå˜é‡,ä¸ç”¨ç®¡,å–ä½™çš„æ—¶å€™ä¼šè‡ªåŠ¨æ¶ˆå¤±
		m1=k1*a1+m1;
		a1=abs(a1/d*a2);
	}
	
	if(x!=-1) x=(m1%a1+a1)%a1;
	
	cout<<x<<endl;
	return 0;
}

```



## 8. é«˜æ–¯æ¶ˆå…ƒ

### 8.1. é«˜æ–¯æ¶ˆå…ƒè§£çº¿æ€§æ–¹ç¨‹ç»„

![image-20231205234751191](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231205234751191.png)

* è¿™ç§é¢˜ä¸€èˆ¬æœ‰ $SPJ$ ä¼˜åŒ–ï¼Œå³ $0.00$ å’Œ $-0.00$ éƒ½è®¤ä¸ºæ˜¯ $0$ï¼Œå³éƒ½è®¤ä¸ºæ˜¯ç›¸åŒçš„å†…å®¹ï¼Œå› ä¸ºåœ¨æ•°å­¦ä¸Š $+0$ å’Œ $-0$ ä»£è¡¨çš„æ¦‚å¿µå’Œæ„ä¹‰éƒ½æ˜¯ä¸€æ ·çš„ã€‚

``` c++
#include <iostream>
#include <cstring>
#include <algorithm>
#include <cmath> // fabs() = float abs = æµ®ç‚¹æ•°çš„ç»å¯¹å€¼ï¼Œç›¸å¯¹åº”çš„ï¼Œæ•´æ•°çš„ç»å¯¹å€¼å³ä¸ºabs()
using namespace std;

// é«˜æ–¯æ¶ˆå…ƒçš„å››éƒ¨æ“ä½œ:
// 1:æ‰¾åˆ°ç»å¯¹å€¼æœ€å¤§çš„ä¸€è¡Œ(ä¸ºäº†ä»£ç çš„ç¨³å®šæ€§)
// 2:å°†è¯¥è¡Œç§»åˆ°æœ€ä¸Šé¢
// 3:å°†æ”¹è¡Œç¬¬ä¸€ä¸ªæ•°å˜ä¸º1
// 4:å°†æœ€ä¸Šé¢ä¸€è¡Œä¸‹é¢çš„æ‰€æœ‰è¡Œçš„ç¬¬cåˆ—å˜ä¸º0
// ä»¥ä¸Š4æ­¥å‡å¯ç”¨åˆç­‰è¡Œå˜æ¢å®Œæˆ

const int N = 110;
const double eps = 1e-8; // é˜²æ­¢å‡ºç°ç²¾åº¦é—®é¢˜

double a[N][N];
int n;

int gauss()
{
	int c = 0, r = 0;
	for(; c < n; c++)
	{
		int t = r;
		for (int i = r; i < n; i ++ ) // ç¬¬ä¸€æ­¥ï¼Œæ‰¾ç»å¯¹å€¼æœ€å¤§çš„è¡Œ
		{
			if(fabs(a[i][c]) > fabs(a[t][c]))
				t = i; 
		}
		
		if(fabs(a[t][c]) < eps) continue; // ä»£è¡¨è¿™ä¸€åˆ—å·²ç»è¢«å¤„ç†è¿‡äº†
		
		for(int i = c; i <= n; i++) // ç¬¬äºŒæ­¥ 
			swap(a[t][i], a[r][i]); // å°†è¿™ä¸€è¡Œè°ƒåˆ°æœ€ä¸Šé¢
		
		for(int i = n; i >= c; i--) // ç¬¬ä¸‰æ­¥
			a[r][i] /= a[r][c]; // è¦å€’ç€ç®—ï¼Œå¦åˆ™ä¼šå½±å“åé¢çš„æ•°
		
		for(int i = r + 1; i < n; i++) // ç¬¬å››æ­¥
		{
			if(fabs(a[i][c]) > eps)  // å¦‚æœæ˜¯0å°±ä¸ç”¨æ“ä½œäº†
			{
				for(int j = n; j >= c; j--)
				{
					a[i][j] -= a[r][j] * a[i][c];
				}
			}
		}
		r++;
	}
	
	if(r < n) // æ–¹ç¨‹æ•° < n
	{
		for(int i = r; i < n; i++)
		{
			if(fabs(a[i][n]) > eps) // 0 != 0
			{
				return 2; // æ— è§£
			}
		}
		
		return 1; // æ— æ•°è§£, 0=0
	}
	
	for(int i = n - 1; i >= 0; i --) // æœ‰è§£ä»ä¸‹å¾€ä¸Šå›ä»£
	{
		for(int j = i + 1; j < n; j++)
		{
			a[i][n] -= a[i][j] * a[j][n];
		}
	}
	return 0;
	
}


int main()
{
	scanf("%d", &n);
	
	for (int i = 0; i < n; i ++ )
		for (int j = 0; j < n + 1; j ++ )
			scanf("%lf", &a[i][j]);
	
	int t = gauss();
	
	if(t == 0)  // æœ‰å”¯ä¸€è§£
	{
		// æœ€åè¾“å‡ºçš„å°±æ˜¯æ¯ä¸ªæœªçŸ¥è§£çš„å€¼:>
		for (int i = 0; i < n; i ++ )
		{
			if(fabs(a[i][n]) < eps) a[i][n] = 0.00; // é¿å…è¾“å‡º-0.00
			printf("%.2lf\n", a[i][n]);
			
		}
	}
	
	else if(t == 1) puts("Infinite group solutions"); // æ— æ•°è§£
	else puts("No solution"); // æ— è§£
	
} 
```



### 8.2. é«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–çº¿æ€§æ–¹ç¨‹ç»„

<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231205235928312.png" alt="image-20231205235928312" style="zoom:80%;" />

* ç³»æ•°å’Œå¸¸æ•°çš„å€¼éƒ½ä¸º $0$ æˆ– $1$ ï¼Œæ¯ä¸ªæœªçŸ¥æ•°çš„å–å€¼ä¹Ÿä¸º $0$ æˆ– $1$ ï¼Œæ–¹ç¨‹ä¸­é—´æ˜¯å¼‚æˆ–è¿ç®—ï¼š

``` c++
#include<bits/stdc++.h>
#define x first
#define y second
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int,int> PII;

// æ ¸å¿ƒæ€æƒ³:å¼‚æˆ–â†’ä¸è¿›ä½çš„åŠ æ³•
// ç­‰å¼ä¸ç­‰å¼ä¹‹é—´çš„å¼‚æˆ–è¦ä¸€èµ·è¿›è¡Œæ‰èƒ½ä¿è¯ç­‰å¼å·¦å³ä¸¤è¾¹ä¾ç„¶æ˜¯ç›¸ç­‰å…³ç³»
// a^b^c=x,d^f=y,åˆ™æœ‰a^b^d^c^f=x^y
// 1. å·¦ä¸‹è§’æ¶ˆ0
// 1.1 æšä¸¾åˆ—
// 1.2 æ‰¾ç¬¬ä¸€ä¸ªéé›¶è¡Œ
// 1.3 äº¤æ¢
// 1.4 æŠŠåŒåˆ—ä¸‹é¢è¡Œæ¶ˆé›¶(å¼‚æˆ–)
// 2. åˆ¤æ–­3ç§æƒ…å†µ
// 2.1 å”¯ä¸€è§£
// 2.2 ç§©<n
// 2.2.1 æœ‰çŸ›ç›¾ æ— è§£
// 2.2.2 æ— çŸ›ç›¾ æ— ç©·å¤šè§£

const int N = 110; // æœ€å¤š110ä¸ªç³»æ•°

int n;
int a[N][N];
int gauss()
{
	int c,r;
	for(c=0,r=0;c<n;c++)
	{
		// æ‰¾ä¸»å…ƒ
		int t=-1;
		for(int i=r;i<n;i++)
			if(a[i][c])
			{
				t=i;
				break;
			}
		if(t==-1) continue;
		// äº¤æ¢ä¸»å…ƒè¡Œ
		for(int j=c;j<=n;j++) swap(a[r][j],a[t][j]);
		// å·¦ä¸‹è§’æ¶ˆ
		for(int i=r+1;i<n;i++)
			if(a[i][c])//æ¼äº†
				for(int j=n;j>=c;j--)//æ¼äº†
					a[i][j] ^= a[r][j];
		r++;
	}
	// åˆ¤æ–­
	if(r<n)
	{
		for(int i=r;i<n;i++) // i=r
			if(a[i][n])
				return 2;
		return 1;
	}
	// æ¶ˆå³ä¸Šè§’
	for(int i=n-1;i>=0;i--)
		for(int j=i+1;j<n;j++)
			//å¦‚æœæ˜¯0 å°±ä¸ç”¨ä¸‹é¢çš„a[j][j] æ¥^a[i][j]äº†
			//å¦‚æœä¸æ˜¯0 æ‰éœ€è¦ç”¨ç¬¬jè¡Œç¬¬jåˆ—a[j][j]æ¥^ç¬¬iè¡Œç¬¬jåˆ—a[i][j] 
			//è¿›è€Œè¿›è¡Œæ•´è¡Œrow[i]^row[j] é—´æ¥å¯¼è‡´ a[i][n]^a[j][n]
			if(a[i][j])
				a[i][n]^=a[j][n];
	return 0;
}

int main()
{
	cin >> n;
	for(int i=0;i<n;i++)
		for(int j=0;j<=n;j++)
			cin >> a[i][j];
	int t = gauss();
	if(t==0)
	{
		for(int i=0;i<n;i++) cout << a[i][n] << endl;
	}
	else if(t==1) puts("Multiple sets of solutions");
	else puts("No solution");
	return 0;
}
```



## 9. ç»„åˆæ•°å­¦

### 9.1. ç»„åˆæ•°

#### 9.1.1. æœ´ç´ æ³•

> æ—¶é—´å¤æ‚åº¦ $O(n^2)$

``` c++
const int mod=1e9+10;
// åˆå§‹åŒ–Cæ•°ç»„
void init() {
	// ä»0å¼€å§‹èµ‹å€¼,æ˜¯ä¸ºäº†è®©C11=C[0][0]+c[0][1]==1,æ­£ç¡®çš„å¾—åˆ°1
	// å…¶å®å°±æ˜¯æŠŠC[N][1~N]å…¨éƒ¨ç®—å‡ºæ¥äº†è€Œå·²
	for(int i=0;i<N;i++) {
		for(int j=0;j<=i;j++) {
			if(!j)
				c[i][j]=1;
			else
				c[i][j]=(c[i-1][j]+c[i-1][j-1])%mod;
		}
	}
}
```



#### 9.1.2. å¿«é€Ÿå¹‚

> æ—¶é—´å¤æ‚åº¦ $O(aÃ—log^{mod})$

<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206090536947.png" alt="image-20231206090536947" style="zoom:80%;" />

* ä¸‰ä¸ªé˜¶ä¹˜çº§åˆ«çš„æ•°éƒ½å¯ä»¥ç”¨å¿«é€Ÿå¹‚è¿…é€Ÿç®—å‡ºï¼Œåœ¨å¯¹ç»„åˆæ•°è¿›è¡Œè¿ç®—æ—¶ï¼Œæˆ‘ä»¬è¦å¯¹ç»„åˆæ•°è¿›è¡Œæ¨¡è¿ç®—ï¼Œç›´æ¥ç”¨é™¤æ³•æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºé™¤æ³•å¾—åˆ°çš„ç»“æœä¸ä¸€å®šæ€»ä¸ºæ•´æ•°ï¼ˆå¯èƒ½æ˜¯æµ®ç‚¹æ•°ï¼‰ï¼Œæ­¤æ—¶å–æ¨¡å°±æ²¡æœ‰æ„ä¹‰ï¼Œéœ€è¦æ‰¾åˆ°åˆ†æ¯çš„ä¹˜æ³•é€†å…ƒï¼Œç„¶åå°†é™¤æ³•è½¬æ¢ä¸ºä¹˜æ³•ï¼Œå¿«é€Ÿå¹‚æ±‚é€†å…ƒä¸å°±æ˜¯è´¹é©¬å°å®šç†å—ï¼Œæ³¨æ„**æ¨¡æ•°å¿…é¡»æ˜¯è´¨æ•°**ï¼š

``` c++
#include<bits/stdc++.h>
#define x first
#define y second
using namespace std;
typedef long long ll;
typedef unsigned long long ull;
typedef pair<int,int> PII;

const int mod=1e9+7; // è¿™æ˜¯ä¸€ä¸ªè´¨æ•°,æ‰€ä»¥ä¸2~1e9+6éƒ½äº’è´¨
const int N=1e5+10; // æ•°å­—èŒƒå›´
ll fac[N]; // å­˜å‚¨é˜¶ä¹˜,åŸºäºæ•°ç»„å®ç°è®°å¿†åŒ–
ll infac[N]; // å­˜å‚¨i!çš„é€†å…ƒ,infac[i]=(i!)^(-1) mod p

// å¿«é€Ÿå¹‚æ¨¡æ¿
ll qmi(ll a,ll k,ll p) {
	ll res=1;
	while(k) {
		if(k&1==1)
			res=res*a%p;
		k>>=1;
		a=a*a%p;
	}
	return res;
}

int main() {
	int n;
	fac[0]=infac[0]=1; // 0çš„é˜¶ä¹˜ä»¥åŠé€†å…ƒéƒ½æ˜¯1
	for(int i=1;i<=N;i++) {
		fac[i]=fac[i-1]*i%mod;
		infac[i]=(ll)infac[i-1]*qmi(i,mod-2,mod)%mod; // æ ¹æ®è´¹é©¬å°å®šç†æ±‚åˆ°i!é€†å…ƒ
	}
	cin>>n;
	while(n--) {
		int a,b;
		cin>>a>>b;
		// cab=a!/(b!)*(a-b)!
		cout<<(ll)fac[a]*infac[b]%mod*infac[a-b]%mod<<endl; // é€šè¿‡ä¹˜æ³•é€†å…ƒè½¬æ¢ä¸ºä¹˜æ³•è¿ç®—
	}
	return 0;
	
}
```



#### 9.1.3. å¢å¡æ–¯å®šç†

> æ—¶é—´å¤æ‚åº¦ $O(plog_pN)$

* å¯¹ä»»æ„éè´Ÿæ•´æ•° $a,b$ å’Œ**è´¨æ•°$p$**ï¼Œæœ‰ï¼š
* å°† $m$ å’Œ $n$ ç”¨ $p$ è¿›åˆ¶è¡¨ç¤ºï¼Œå¤æ‚åº¦ä¸º $O(log_pn)$ï¼Œå¦‚æœå†ç”¨å¿«é€Ÿå¹‚æ±‚é€†å…ƒè®¡ç®—ç»„åˆæ•°ï¼Œå¤æ‚åº¦ä¸º$O(p)$ï¼Œæ•…æ€»æ—¶é—´å¤æ‚åº¦ä¸º$O(plog_pN)$ï¼Œè¿™é‡Œçš„ $N$ æ˜¯ $a,b$ çš„æ—¶é—´å¤æ‚åº¦çº¦ä¸º$10^{18}$ï¼Œå¦‚æœé¢„å¤„ç†é˜¶ä¹˜å’Œé˜¶ä¹˜é€†å…ƒï¼Œæ—¶é—´å¤æ‚åº¦èƒ½ä¸‹é™è‡³$O(p+log_pN)$

<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206093200137.png" alt="image-20231206093200137" style="zoom:80%;" />

* å…¶è¯æ˜éœ€è¦ç”¨åˆ°ä¸¤ä¸ªé‡è¦ç­‰å¼ï¼Œè¿™é‡Œä¸å†è¯æ˜ï¼š

<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206093244681.png" alt="image-20231206093244681" style="zoom:80%;" />

``` c++
#include<iostream>
#include<algorithm>

using namespace std;
typedef long long LL;

int qmi(int a,int k,int p)
{
	int res = 1;
	while(k)
	{
		if(k&1)res = (LL)res*a%p;
		a = (LL)a*a%p;
		k>>=1;
	}
	return res;
}

int C(int a,int b,int p)//è‡ªå˜é‡ç±»å‹int
{
	if(b>a)return 0;//æ¼äº†è¾¹ç•Œæ¡ä»¶
	int res = 1;
	// a!/(b!(a-b)!) = (a-b+1)*...*a / b! åˆ†å­æœ‰bé¡¹
	for(int i=1,j=a;i<=b;i++,j--)//i<=bè€Œä¸æ˜¯<
	{
		res = (LL)res*j%p;
		res = (LL)res*qmi(i,p-2,p)%p;
	}
	return res;
}
//å¯¹å…¬å¼æ•²
int lucas(LL a,LL b,int p)
{
	if(a<p && b<p)return C(a,b,p);//lucasé€’å½’ç»ˆç‚¹æ˜¯C_{bk}^{ak}
	return (LL)C(a%p,b%p,p)*lucas(a/p,b/p,p)%p;//a%påè‚¯å®šæ˜¯<pçš„,æ‰€ä»¥å¯ä»¥ç”¨C(),ä½†a/påä¸ä¸€å®š<p æ‰€ä»¥ç”¨lucasç»§ç»­é€’å½’
}

int main()
{
	int n;
	cin >> n;
	while(n--)
	{
		LL a,b;
		int p;
		cin >> a >> b >> p;
		cout << lucas(a,b,p) << endl;
	}
	return 0;
}

```



#### 9.1.4. çº¿æ€§ç­›+é«˜ç²¾ä¹˜

> æ—¶é—´å¤æ‚åº¦è¿‘ä¼¼ $O(n)$

* é¢˜ç›®å˜å¾—æ›´åŠ ç®€å•ç²—æš´ï¼Œå®ç°æ–¹æ³•ï¼šç”±äº $a$ å’Œ $b$ çš„æœ€å¤§å–å€¼æ˜¯ $5000$ï¼Œæ‰€ä»¥ç”¨çº¿æ€§ç­›åœ¨ $[1,5000]$ çš„èŒƒå›´å†…ç­›é€‰å‡ºè´¨æ•°ï¼Œæ±‚æ¯ä¸ªè´¨æ•°çš„æ¬¡æ•°ï¼Œå†ç”¨é«˜ç²¾åº¦ä¹˜æ³•æŠŠæ‰€æœ‰è´¨å› å­ä¹˜ä¸Šï¼š

<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206144822955.png" alt="image-20231206144822955" style="zoom:80%;" />

``` c++
#include<iostream>
#include<algorithm>
#include<vector>

using namespace std;

const int N=5010;

int primes[N],cnt; // primes[N]:ä¾æ¬¡å­˜æ”¾1~Nä¸­å‡ºç°çš„è´¨æ•°
int sum[N];
bool st[N];

void get_primes(int n)
{
	for(int i=2;i<=n;i++)
	{
		if(!st[i])primes[cnt++]=i;
		for(int j=0;primes[j]*i<=n;j++)
		{
			st[primes[j]*i]=true;
			if(i%primes[j]==0)
				break; // ==0æ¯æ¬¡æ¼
		}
	}
}

// å¯¹pçš„å„ä¸ª<=açš„æ¬¡æ•°ç®—æ•´é™¤ä¸‹å–æ•´å€æ•°
int get(int n,int p)
{
	int res =0;
	while(n)
	{
		res+=n/p;
		n/=p;
	}
	return res;
}

// é«˜ç²¾åº¦ä¹˜
vector<int> mul(vector<int> a, int b)
{
	vector<int> c;
	int t = 0;
	for (int i = 0; i < a.size(); i ++ )
	{
		t += a[i] * b;
		c.push_back(t % 10);
		t /= 10;
	}
	while (t)
	{
		c.push_back(t % 10);
		t /= 10;
	}
	// while(C.size()>1 && C.back()==0) C.pop_back();//è€ƒè™‘b==0æ—¶æ‰æœ‰popå¤šä½™çš„0 b!=0ä¸éœ€è¦è¿™è¡Œ
	return c;
}

int main()
{
	int a,b;
	cin >> a >> b;
	get_primes(a);
	
	for(int i=0;i<cnt;i++)
	{
		int p = primes[i];
		sum[i] = get(a,p)-get(a-b,p)-get(b,p); // æ˜¯a-bä¸æ˜¯b-a
	}
	
	vector<int> res;
	res.push_back(1);
	
	for (int i = 0; i < cnt; i ++ )
		for (int j = 0; j < sum[i]; j ++ ) // primes[i]çš„æ¬¡æ•°
			res = mul(res, primes[i]);
	
	for (int i = res.size() - 1; i >= 0; i -- ) 
		printf("%d", res[i]);
	puts("");
	
	return 0;
}
```



### 9.2. å¡ç‰¹å…°æ•°

![image-20231206150423021](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206150423021.png)

* è‹¥æŠŠ $0$ å’Œ $1$ ç½®äºåæ ‡è½´ä¸­ï¼Œèµ·ç‚¹å®šäºåŸç‚¹ï¼Œè‹¥ $0$ è¡¨ç¤ºå‘å³èµ°ï¼Œ$1$ è¡¨ç¤ºå‘ä¸Šèµ°ï¼Œé‚£ä¹ˆä»»ä½•å‰ç¼€ä¸­ $0$ çš„ä¸ªæ•°ä¸å°‘äº $1$ çš„ä¸ªæ•°å°±è½¬æ¢ä¸ºï¼šå¯¹äºè·¯å¾„ä¸Šçš„ä»»æ„ä¸€ç‚¹ï¼Œæ¨ªåæ ‡å¤§äºç­‰äºçºµåæ ‡ï¼Œé¢˜ç›®æ‰€æ±‚å³ä¸ºè¿™æ ·çš„åˆæ³•è·¯å¾„æ•°é‡ï¼š

<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/6828_9476d97655-Catalan.png" alt="Catalan.png" style="zoom: 50%;" />

* ç”±å›¾å¯çŸ¥ï¼Œä»»ä½•ä¸€æ¡ä¸åˆæ³•çš„è·¯å¾„ï¼ˆé»‘è‰²è·¯å¾„ï¼‰ï¼Œéƒ½å¯¹åº”ä¸€æ¡ä» $(0,0)$ èµ°åˆ° $(n-1,n+1)$ çš„è·¯å¾„ï¼ˆç°è‰²è·¯å¾„ï¼‰ï¼Œè€Œä»»ä½•ä¸€æ¡ä» $(0,0)$ èµ°åˆ° $(n-1,n+1)$ çš„è·¯å¾„ï¼Œä¹Ÿå¯¹åº”ä¸€æ¡ä»$(0,0)$ èµ°åˆ° $(n,n)$ çš„ä¸åˆæ³•è·¯å¾„ï¼š$ ans=C_{2n}n-C_{2n}{n-1}=C_{2n}n/n+1$

``` c++
#include <bits/stdc++.h>
using namespace std;

typedef long long LL;
const int N = 200010, mod = 1e9 + 7;

int n;
int fact[N], infact[N]; // fact[i]:i!çš„é˜¶ä¹˜,infact[i]:i!é˜¶ä¹˜é€†å…ƒ

int ksm(int a, int k) {
	int res = 1;
	while (k) {
		if (k & 1) res = (LL)res * a % mod;
		a = (LL)a * a % mod;
		k >>= 1;
	}
	return res;
}

void init() {
	fact[0] = infact[0] = 1;
	for (int i = 1; i < N; i++) {
		fact[i] = (LL)fact[i - 1] * i % mod;
		infact[i] = (LL)infact[i - 1] * ksm(i, mod - 2) % mod;
	}
}

int main() {
	init();
	cin >> n;
	int res = (LL)fact[2 * n] * infact[n] % mod * infact[n] % mod * ksm(n + 1, mod - 2) % mod;
	cout << res << endl;
	return 0; 
}
```



## 10. å®¹æ–¥åŸç†

* æ³¨æ„æ¬§æ‹‰å‡½æ•°çš„æ¨å¯¼è¿ç”¨åˆ°äº†å®¹æ–¥åŸç†ï¼Œæ¬§æ‹‰å‡½æ•°æ±‚å–çš„æ˜¯ $[1,n]$ å½“ä¸­ä¸ $n$ äº’è´¨çš„æ•°çš„ä¸ªæ•°ï¼š

![image-20231206152700721](https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206152700721.png)

* æ¯”å¦‚ $n=10,\ p1=2,\ p2=3$ï¼Œæ±‚$[1,10]$ä¸­æ»¡è¶³èƒ½æ•´é™¤ $p_1$ æˆ– $p_2$ çš„ä¸ªæ•°å³ï¼š$2,\ 3,\ 4,\ 6,\ 8,\ 9,\ 10$ å…± $7$ ä¸ª

<img src="https://gitee.com/RoysterCDD/figurebed/raw/master/img/image-20231206153027100.png" alt="image-20231206153027100" style="zoom:80%;" />

``` c++
#include<iostream>
using namespace std;
typedef long long LL;

const int N = 20;
int p[N], n, m;

int main() {
	cin >> n >> m;
	for(int i = 0; i < m; i++) cin >> p[i];
	int res = 0;
	// æšä¸¾ä»1 åˆ° 1111...(mä¸ª1)çš„æ¯ä¸€ä¸ªé›†åˆçŠ¶æ€,(è‡³å°‘é€‰ä¸­ä¸€ä¸ªé›†åˆ)
	for(int i = 1; i < 1 << m; i++) {
		int t = 1; // é€‰ä¸­é›†åˆå¯¹åº”è´¨æ•°çš„ä¹˜ç§¯
		int s = 0; // é€‰ä¸­çš„é›†åˆæ•°é‡
		// æšä¸¾å½“å‰çŠ¶æ€çš„æ¯ä¸€ä½
		for(int j = 0; j < m; j++){
			// é€‰ä¸­ä¸€ä¸ªé›†åˆ
			if(i >> j & 1) {
				// ä¹˜ç§¯å¤§äºn,åˆ™n/t = 0,è·³å‡ºè¿™è½®å¾ªç¯
				if((LL)t * p[j] > n) {    
					t = -1;
					break;
				}
				s++; // æœ‰ä¸€ä¸ª1,é›†åˆæ•°é‡+1
				t *= p[j];
			}
		}
		if(t == -1) 
			continue;  	
		if(s & 1) 
			res += n / t; // é€‰ä¸­å¥‡æ•°ä¸ªé›†åˆ, åˆ™ç³»æ•°åº”è¯¥æ˜¯1, n/tä¸ºå½“å‰è¿™ç§çŠ¶æ€çš„é›†åˆæ•°é‡
		else 
			res -= n / t; // åä¹‹åˆ™ä¸º -1
	}
	cout << res << endl;
	return 0;
} 
```
